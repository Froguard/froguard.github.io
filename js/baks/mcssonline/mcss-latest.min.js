var mcss;!function(modules){var cache={},require=function(id){var module=cache[id];if(!module){module=cache[id]={};var exports=module.exports={};modules[id].call(exports,require,module,exports,window)}return module.exports};mcss=require("0")}({0:function(require,module,exports,global){var mcss=module.exports=require("1");mcss.env="BROWSER";var path=(global.mcssOptions||{},mcss.path),io=mcss.io,$=function(selector){return mcss._.slice(document.querySelectorAll(selector))},text=function(node){return node.innerText||node.contentText};$('link[rel="stylesheet/mcss"], style[type="text/mcss"]').forEach(function(node){var nodename=node.nodeName.toLowerCase(),style=document.createElement("style");if(document.head.appendChild(style),"link"===nodename){var filename=path.join(path.dirname(location.pathname),node.getAttribute("href"));io.get(filename).done(function(text){mcss({filename:filename}).translate(text).done(function(mcssContent){style.textContent=mcssContent}).fail(function(error){mcss.error.format(error),console.error(error.message)})}).fail(function(error){})}else{var filename=location.pathname;mcss({filename:filename}).translate(text(node)).done(function(mcssContent){style.textContent=mcssContent}).fail(function(error){mcss.error.format(error),console.error(error.message)})}document.head.removeChild(node)})},1:function(require,module,exports,global){function Mcss(options){"string"==typeof options.prefix&&(options.prefix=options.prefix.split(/\s+/)),this.options=_.extend(options,{imports:{},importCSS:!1,pathes:[],walkers:[],format:1,sourcemap:!1,variables:{}});var walkers=this.get("walkers");Array.isArray(walkers)||(walkers=[walkers]),this.set("walkers",walkers.map(function(hook){return"string"==typeof hook&&(hook=hooks[hook]),hook}))}var Parser=require("2"),Interpreter=require("j"),Translator=require("p"),tk=require("3"),promise=require("e"),functions=require("o"),path=require("6"),_=require("4"),io=require("i"),options=require("f"),error=require("a"),hooks=require("s"),helper=require("w"),state=require("h"),m=options.mixTo(Mcss);m.include=function(path){var pathes=this.get("pathes");return Array.isArray(path)?this.set("pathes",pathes.concat(path)):pathes.push(path),this},m.walk=function(type){return"string"==typeof type?(walker={},walker[type]=arguments[1]):walker=type,this.get("walkers").push(walker),this},m.define=_.msetter(function(key,value){return"function"==typeof value&&functions[key]===value,this}),m.var2text=function(){var variables=this.options.variables;if(!variables)return"";var arr=[];for(var key in variables)variables.hasOwnProperty(key)&&arr.push("$"+key+"="+variables[key]+";");return arr.join("")},m.tokenize=function(text){return tk.tokenize(text,this.options)},m.parse=function(text){var options=this.options,parser=new Parser(this.options),pr=promise(),var2text=this.var2text;if(void 0===text){if(!this.get("filename"))throw Error("text or filename is required");io.get(this.options.filename).done(function(text){new Parser(options).parse(var2text()+text).always(pr)}).fail(pr)}else parser.parse(this.var2text()+text).always(pr);return pr},m.interpret=function(text){var options=this.options,interpreter=new Interpreter(options),pr=promise(),walkers=options.walkers;return walkers.length&&walkers.forEach(function(hook){hook&&interpreter.on(hook)}),this.parse(text).done(function(ast){try{ast=interpreter.interpret(ast),pr.resolve(ast)}catch(e){pr.reject(e)}}).fail(pr),pr},m.translate=function(text){var options=this.options,translator=new Translator(options),interpreter=new Interpreter(options),pr=promise(),walkers=options.walkers;return walkers.length&&walkers.forEach(function(hook){hook&&interpreter.on(hook)}),this.parse(text).done(function(ast){Date.now();try{ast=interpreter.interpret(ast),pr.resolve(translator.translate(ast))}catch(e){pr.reject(e)}}).fail(pr),pr};var mcss=module.exports=function(options){return new Mcss(options||{})};mcss.Parser=Parser,mcss.Interpreter=Interpreter,mcss.Translator=Translator,mcss.Tokenizer=tk.Tokenizer,mcss.node=require("8"),mcss.io=io,mcss.promise=promise,mcss._=_,mcss.error=error,mcss.path=path,mcss.helper=helper,mcss.state=state,mcss.connect=function(options){return function(){}}},2:function(require,module,exports,global){function Parser(options){this.options=options||{}}module.exports=Parser;var tk=require("3"),tree=require("8"),directive=require("c"),_=require("4"),binop=require("d"),promise=require("e"),options=require("f"),path=require("6"),fs=null,sysUrl=null,symtab=require("g"),state=require("h"),error=require("a"),io=require("i"),remoteFileCache=state.remoteFileCache,perror=new Error,errors=([].slice,{INTERPOLATE_FAIL:1,DECLARION_FAIL:2,FILE_NOT_FOUND:3}),assignMap={"=":1,"?=":2,"^=":3},combos=["WS",">","~","+"],skipStart="WS NEWLINE COMMENT ;",operators="+ - * /",isSkipStart=_.makePredicate(skipStart),isSelectorSep=(_.makePredicate(combos),_.makePredicate(combos.concat(["PSEUDO_CLASS","PSEUDO_ELEMENT","ATTRIBUTE","CLASS","HASH","&","TEXT","*","#","#{",":",".","%","-","compoundident","DIMENSION"]))),isWSOrNewLine=(_.makePredicate(operators),_.makePredicate("aliceblue antiquewhite aqua aquamarine azure beige bisque black blanchedalmond blue blueviolet brown burlywood cadetblue chartreuse chocolate coral cornflowerblue cornsilk crimson cyan darkblue darkcyan darkgoldenrod darkgray darkgrey darkgreen darkkhaki darkmagenta darkolivegreen darkorange darkorchid darkred darksalmon darkseagreen darkslateblue darkslategray darkslategrey darkturquoise darkviolet deeppink deepskyblue dimgray dimgrey dodgerblue firebrick floralwhite forestgreen fuchsia gainsboro ghostwhite gold goldenrod gray grey green greenyellow honeydew hotpink indianred indigo ivory khaki lavender lavenderblush lawngreen lemonchiffon lightblue lightcoral lightcyan lightgoldenrodyellow lightgray lightgrey lightgreen lightpink lightsalmon lightseagreen lightskyblue lightslategray lightslategrey lightsteelblue lightyellow lime limegreen linen magenta maroon mediumaquamarine mediumblue mediumorchid mediumpurple mediumseagreen mediumslateblue mediumspringgreen mediumturquoise mediumvioletred midnightblue mintcream mistyrose moccasin navajowhite navy oldlace olive olivedrab orange orangered orchid palegoldenrod palegreen paleturquoise palevioletred papayawhip peachpuff peru pink plum powderblue purple red rosybrown royalblue saddlebrown salmon sandybrown seagreen seashell sienna silver skyblue slateblue slategray slategrey snow springgreen steelblue tan teal thistle tomato turquoise violet wheat white whitesmoke yellow yellowgreen"),_.makePredicate("mixin extend var"),_.makePredicate("if else css for"),_.makePredicate("import page keyframe media font-face charset"),_.makePredicate("background font margin border border-top border-right border-bottom border-left border-width border-color border-style transition padding list-style border-radius."),_.makePredicate("WS NEWLINE")),isRelationOp=(_.makePredicate(", )"),_.makePredicate("DIMENSION STRING BOOLEAN TEXT NULL"),_.makePredicate("== >= <= < > !=")),isProbablyModulePath=function(path){return/^[-\w]/.test(path)&&!/:/.test(path)},states={FILTER_DECLARATION:_.uid(),TRY_DECLARATION:_.uid(),TRY_INTERPOLATION:_.uid(),FUNCTION_CALL:_.uid()};Parser.prototype={parse:function(tks){try{var p=new promise;if("string"==typeof tks){var filename=this.get("filename");filename&&!this.get("imports")[filename]&&(this.get("imports")[filename]=tks),tks=tk.tokenize(tks,this.options)}this.lookahead=tks,this.p=0,this.length=this.lookahead.length,this._states={},this.scope=this.options.scope||new symtab.Scope,this.marked=null,this.promises=[];var ast=this.stylesheet()}catch(e){return p.reject(e)}return this.promises.length?(promise.when.apply(this,this.promises).done(function(){return p.resolve(ast)}).fail(function(err1){p.reject(err1)}),p):p.resolve(ast)},state:function(state){return this._states[state]===!0},enter:function(state){this._states[state]=!0},leave:function(state){this._states[state]=!1},next:function(k){k=k||1,this.p+=k},lookUpBefore:function(lookup,before){for(var la,i=1;i++;){if((la=this.la(i))===lookup)return!0;if(la===before||"EOF"===la||"}"===la)return!1}return!1},match:function(tokenType){var ll;if(ll=this.eat.apply(this,arguments))return ll;var ll=this.ll();this.error('expect:"'+tokenType+'" -> got: "'+ll.type+'"',ll.lineno,tokenType)},matchSemiColonIfNoBlock:function(){this.eat("WS"),"}"!==this.la()&&this.match(";")},ll:function(k){k=k||1,k<0&&(k+=1);var pos=this.p+k-1;return pos>this.length-1?this.lookahead[this.length-1]:this.lookahead[pos]},la:function(k){return this.ll(k).type},is:function(pos,tokenType){return this.la(pos)===tokenType},mark:function(){return this.marked=this.p,this},restore:function(){return void 0!=this.marked&&(this.p=this.marked),this.marked=null,this},eat:function(tokenType){for(var ll=this.ll(),i=0,len=arguments.length;i<len;i++)if(ll.type===arguments[i])return this.next(),ll;return!1},skip:function(type){for(var skiped,la,test;;){if(la=this.la(),test="string"==typeof type?type===la:type(la),!test)break;this.next(),skiped=!0}return skiped},skipStart:function(){return this.skip(isSkipStart)},skipWSorNewlne:function(){return this.skip(isWSOrNewLine)},error:function(msg,ll,expect){if("number"==typeof msg)throw perror.code=msg,perror.message="Uncauched Error",perror;var lineno=ll.lineno||ll,err=new error.SyntaxError(msg,lineno,this.options);throw expect&&(err.expect=expect),err},stylesheet:function(){return this.block(!0)},stmt:function(){var ll=this.ll(),la=ll.type,node=!1;if("AT_KEYWORD"===la&&(node=this.atrule()),"VAR"===la)switch(this.la(2)){case"(":node=this.fnCall(),this.matchSemiColonIfNoBlock();break;case":":node=this.transparentCall(),this.matchSemiColonIfNoBlock();break;case"=":case"?=":case"^=":node=this.assign(),"func"!==node.value.type&&this.matchSemiColonIfNoBlock();break;default:this.error("UNEXPECT token after VARIABLE",this.ll(2))}return"FUNCTION"===la&&(node=this.fnCall(),this.matchSemiColonIfNoBlock()),isSelectorSep(la)&&(node=this.ruleset(!0)),node!==!1?node:void this.error("INVALID statementstart "+ll.type,ll)},atrule:function(){var fullname=this.ll().value.toLowerCase(),name=this._removePrefix(fullname);if("function"==typeof this[name])var node=this[name]();else node=this.directive();return node.fullname=fullname,node},directive:function(){var ll=this.ll(),name=ll.value.toLowerCase(),dhook=directive.getDirective(name);if(!dhook){this.match("AT_KEYWORD"),this.eat("WS");var value=this.valuesList();if(this.eat("WS"),this.eat(";"))return tree.directive(name,value);var block=this.block();return tree.directive(name,value,block)}console.log("has hook")},extend:function(){var ll=this.match("AT_KEYWORD");this.eat("WS");var node=tree.extend(this.selectorList());return node.lineno=ll.lineno,this.matchSemiColonIfNoBlock(),node},return:function(){this.match("AT_KEYWORD"),this.eat("WS");var value=this.assignExpr(!0),node=new tree.ReturnStmt(value);return this.skip("WS"),value&&"func"!==value.type&&this.matchSemiColonIfNoBlock(),node},import:function(){var node,url,queryList,ll,la;this.match("AT_KEYWORD"),this.eat("WS"),ll=this.ll(),la=this.la(),"STRING"===la||"URL"===la?(url=ll,this.next()):this.error("expect URL or STRING got "+ll.type,ll.lineno),this.eat("WS"),this.eat(";")||(queryList=this.media_query_list(),this.matchSemiColonIfNoBlock());var p,node=new tree.Import(url,queryList),extname=path.extname(url.value);if(".css"===extname&&this.get("importCSS"),".css"!==extname||this.get("importCSS")){extname||(url.value+=".mcss");var p=this._import(url,node).done(function(ast){ast&&(node.stylesheet=ast)});this.promises.push(p)}return node},abstract:function(){var la,url,ruleset;if(this.match("AT_KEYWORD"),this.eat("WS"),"{"!==(la=this.la())){if(url=this.eat("STRING","URL")){var node=new tree.Import(url),p=this._import(url,node).done(function(ast){ast&&(node.stylesheet=ast.abstract())});return this.promises.push(p),this.matchSemiColonIfNoBlock(),node}return ruleset=this.ruleset(),ruleset.abstract=!0,ruleset}var list=this.block().abstract().list;return list},url:function(){return this.match("STRING","URL")},if:function(){this.match("AT_KEYWORD");var alt,ll,test=this.expression(),block=this.block();return this.eat("WS"),ll=this.ll(),"AT_KEYWORD"==ll.type&&("else"===ll.value&&(this.next(),this.eat("WS"),alt=this.block()),"elseif"===ll.value&&(alt=this.if())),new tree.IfStmt(test,block,alt)},for:function(){var element,index,list,of,block,by;return this.match("AT_KEYWORD"),this.eat("WS"),element=this.ll().value,this.match("VAR"),this.eat(",")&&(index=this.ll().value,this.match("VAR")),this.eat("WS"),"by"===this.ll().value&&(this.next(),this.eat("WS"),by=this.expression(),this.eat("WS")),of=this.match("TEXT"),"of"!==of.value&&"in"!==of.value&&this.error("for statement need of or in KEYWORD but got:"+of.value,of.lineno),list=this.valuesList(),this.eat("WS"),block=this.block(),new tree.ForStmt(element,index,list,block,"in"==of.value,by)},media:function(){this.match("AT_KEYWORD"),this.eat("WS");var list=this.media_query_list();this.skip("WS");var block=this.block();return new tree.Media(list,block)},media_query_list:function(){var list=[];do list.push(this.media_query());while(this.eat(","));return list},media_query:function(){var ll,expressions=[],type="";for("("===this.la()?expressions.push(this.media_expression()):(ll=this.ll(),"only"!==ll.value&&"not"!==ll.value||(type=ll.value,this.next(1),this.eat("WS"),ll=this.ll()),this.match("TEXT"),type+=(type?" ":"")+ll.value),this.eat("WS");"TEXT"===(ll=this.ll()).type&&"and"===ll.value;)this.next(),this.eat("WS"),expressions.push(this.media_expression()),this.eat("WS");return new tree.MediaQuery(type,expressions)},media_expression:function(){var feature,value;return this.match("("),this.eat("WS"),feature=this.expression(),this.eat(":")&&(value=this.valuesList()),this.eat("WS"),this.match(")"),new tree.MediaExpression(feature,value)},keyframes:function(){var lineno=this.ll().lineno;this.match("AT_KEYWORD"),this.eat("WS");var name=this.expression();name||this.error("@keyframes's name should specify",lineno),"FUNCTION"===name.type&&(this.eat("WS"),this.match("("),this.eat("WS")),this.eat("WS");var block=this.block(),node=new tree.Keyframes(name,block);return node},keyframe:function(){var steps=[];do steps.push(this.expression());while(this.eat(","));var block=this.block();return new tree.Keyframe(steps,block)},page:function(){var keyword=this.match("AT_KEYWORD");this.eat("WS");var selector=this.complexSelector().string;this.eat("WS");var block=this.block();return tree.directive("page",tk.createToken("TEXT",selector,keyword.lineno),block)},debug:function(){this.match("AT_KEYWORD"),this.eat("WS");var value=this.valuesList(),node=new tree.Debug(value);return this.matchSemiColonIfNoBlock(),node},vain:function(){var selector,block;this.match("AT_KEYWORD"),this.eat("WS"),"{"!==this.la()?selector=this.selectorList():block=this.block()},ruleset:function(){var node=new tree.RuleSet;return node.selector=this.selectorList(),this.eat("WS"),node.block=this.block(),node},block:function(noBlock){var end=noBlock?"EOF":"}";this.eat("WS");var node=new tree.Block;for(noBlock||this.match("{"),this.skip("WS");!this.eat(end);){if(noBlock)var declareOrStmt=this.stmt();else declareOrStmt=this.mark().declaration()||this.restore().stmt();node.list.push(declareOrStmt),this.skipStart()}return node},selectorList:function(){var node=new tree.SelectorList;do node.list.push(this.complexSelector());while(this.eat(","));return node.lineno=node.list[0].lineno,node},complexSelector:function(){for(var value,ll,interpolation,node=new tree.ComplexSelector,selectorString="",i=0;;)if(ll=this.ll(),"#{"===ll.type&&"}"!==this.ll(2)){if(interpolation=this.interpolation(),!interpolation)break;selectorString+="#{"+i++ +"}",node.interpolations.push(interpolation)}else{if(!isSelectorSep(ll.type))break;value="DIMENSION"===ll.type?tree.toStr(ll):ll.value||("WS"===ll.type?" ":ll.type),selectorString+=value,this.next()}return node.string=selectorString,node.lineno=ll.lineno,node},declaration:function(noEnd){var node=new tree.Declaration,ll1=this.ll(1),ll2=this.ll(2);if("*"===ll1.type&&"TEXT"==ll2.type&&(this.next(1),ll2.value="*"+ll2.value),node.property=this.compoundIdent(),node.property&&(this.eat("WS"),this.eat(":"))){node.property.value&&/filter$/.test(node.property.value.toLowerCase())&&this.enter(states.FILTER_DECLARATION),this.enter(states.TRY_DECLARATION);try{node.value=this.valuesList(),this.leave(states.TRY_DECLARATION)}catch(error){if(this.leave(states.TRY_DECLARATION),error.code===errors.DECLARION_FAIL)return;throw error}return this.eat("IMPORTANT")&&(node.important=!0),noEnd||this.matchSemiColonIfNoBlock(),this.leave(states.FILTER_DECLARATION),node}},valuesList:function(){var values,list=[];do{if(values=this.values(),!values)break;list.push(values)}while(this.eat(","));return 1===list.length?list[0]:new tree.ValuesList(list)},values:function(){for(var value,list=[];;){if(value=this.expression(),!value)break;list.push(value)}return 1===list.length?list[0]:0===list.length?null:new tree.Values(list)},assign:function(){var value,ll=this.ll(),name=ll.value;this.match("VAR");var op=this.match("=","?=","^=").type;return value=this.assignExpr(!0),new tree.Assign(name,value,assignMap[op]||1)},assignExpr:function(hasComma){var la=this.la(),fn=hasComma?"valuesList":"values";if("{"===la)return this.func();if("("!==la)return this[hasComma?"valuesList":"values"]();this.mark();try{var res=this.func();return res}catch(e){if(e.expect&&"{"==e.expect||"VAR"==e.expect||")"==e.expect)return this.restore(),this[fn]();throw e}},func:function(){var params,block;this.ll().lineno;if(this.eat("(")){this.eat("WS");var params=this.params();this.match(")")}return block=this.block(),new tree.Func(params,block)},params:function(){var rest=0,params=[];if(")"!==this.la()){do{var param=this.param();param.rest&&rest++,params.push(param)}while(this.eat(","));rest>=2&&this.error("can not have more than 2 rest param",lineno),this.eat("WS")}return params},param:function(){var dft,ll=this.ll(),name=ll.value,rest=!1;return this.match("VAR"),this.eat("...")&&(rest=!0),this.eat("=")&&(rest&&this.error('rest type param can"t have default params',ll),dft=this.values()),new tree.Param(name,dft,rest)},expression:function(){return this.eat("WS"),this.logicOrExpr()},logicOrExpr:function(){for(var la,right,left=this.logicAndExpr();"||"===(la=this.la());){this.next(),right=this.logicAndExpr(),right||this.error(la+" require right operand",left);var bValue=tree.toBoolean(left);null!=bValue?bValue===!1&&(left=right):left=new tree.Operator(la,left,right),this.eat("WS")}return left},logicAndExpr:function(){for(var la,right,node=this.relationExpr();"&&"===(la=this.la());){this.next(),right=this.relationExpr(),right||this.error(la+" require right operand",node);var bValue=tree.toBoolean(node);null!=bValue?bValue===!0&&(node=right):node=new tree.Operator(la,node,right),this.eat("WS")}return node},relationExpr:function(){for(var la,right,left=this.binop1();isRelationOp(la=this.la());)this.next(),this.eat("WS"),right=this.binop1(),right||this.error(la+" require right operand",left),left=tree.isPrimary(left.type)&&tree.isPrimary(right.type)?binop.relation.call(this,left,right,la):new tree.Operator(la,left,right),this.eat("WS");return left},binop1:function(){var right,la,left=this.binop2();for(this.eat("WS");"+"===(la=this.la())||"-"===la;)this.next(),this.eat("WS"),right=this.binop2(),right||this.error(la+" require right operand",left),left="DIMENSION"===right.type&&"DIMENSION"===left.type?binop[la].call(this,left,right):new tree.Operator(la,left,right),this.eat("WS");return left},binop2:function(){var right,la,ws,left=this.unary();if(this.eat("WS")&&(ws=!0),la=this.la(),"..."===la)return this.next(),this.eat("WS"),right=this.unary(),tree.range(left,right,left.lineno);for(;"*"===la||"/"===la||"%"===la;){if("/"==la&&!ws&&"WS"!==this.la(2))return left;this.next(),this.eat("WS"),right=this.unary(),right||this.error(la+" require right operand",left),left="DIMENSION"===right.type&&"DIMENSION"===left.type?binop[la].call(this,left,right):new tree.Operator(la,left,right),this.eat("WS"),la=this.la()}return left},unary:function(){var value,la,ll=this.ll();if("-"===(la=ll.type)||"+"===la||"!"===la){this.next(),this.eat("WS"),value=this.unary();var node=new tree.Unary(value,la);return node.lineno=ll.lineno,node}return this.primary()},primary:function(){var node,value,ll=this.ll();switch(ll.type){case"(":return this.parenExpr();case"=":if(this.state(states.FILTER_DECLARATION)&&this.state(states.FUNCTION_CALL))return this.next(),ll;break;case"/":return this.next(),ll;case"-":var ll2=this.ll(2);if("TEXT"===ll2.type||"#{"===ll2.type)return this.CompoundIdent();case"#{":case"TEXT":return this.compoundIdent();case"FUNCTION":return this.fnCall();case"HASH":return this.next(),value=ll.value,/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(value)?(node=new tree.Color(value),node.lineno=ll.lineno):node=new tree.Unknown(ll.value),node;case"STRING":case"DIMENSION":case"BOOLEAN":case"VAR":case"NULL":case"URL":return this.next(),ll;case">":case"~":case"+":case".":case"#":case"&":case"{":case":":case"*":case"PSEUDO_CLASS":case"CLASS":case"ATTRIBUTE":if(this.state(states.TRY_DECLARATION)){this.error(errors.DECLARION_FAIL);break}default:return null}},parenExpr:function(){this.match("("),this.eat("WS");var lineno=this.ll().lineno,node=this.valuesList();return node.lineno=lineno,this.eat("WS"),this.match(")"),node},compoundIdent:function(){for(var ll,sep,node,list=[],slineno=this.ll().lineno;;)if(ll=this.ll(),"#{"===ll.type)sep=this.interpolation(),list.push(sep);else{if("TEXT"!==ll.type&&"-"!==ll.type)break;this.next(),list.push(ll.value||ll.type)}return sep?(node=new tree.CompoundIdent(list),node.lineno=slineno,node):list.length?{type:"TEXT",value:list[0],lineno:slineno}:null},interpolation:function(){var node;return this.match("#{"),node=this.valuesList(),this.match("}"),node},fnCall:function(){var pargs,ll=this.ll(),name=ll.value;if(this.match("FUNCTION","VAR"),ll.args)return tree.call(name,ll.args,null,ll.lineno);this.eat("WS"),this.match("("),this.enter(states.FUNCTION_CALL),this.eat("WS");var la=this.la();pargs=")"!==la?this.args():{args:[]},this.leave(states.FUNCTION_CALL),this.match(")");var node=tree.call(name,pargs.args,pargs.named,ll.lineno);return node},args:function(end){var ll,args=[],named=null,i=0;do{var ll=this.ll();"VAR"===ll.type&&"="===this.la(2)&&(this.next(2),named||(named={}),named[ll.value]=i),args.push(this.assignExpr()),this.skip("WS"),i++}while(this.eat(","));return{args:args,named:named}},transparentCall:function(){var ll=this.ll(),name=ll.value;this.match("VAR"),this.match(":"),this.eat("WS");var pargs=this.args();return tree.call(name,pargs.args,pargs.named,ll.lineno)},_lookahead:function(){return this.lookahead.map(function(item){return item.type}).join(",")},_import:function(url,node){var pathes=this.get("pathes"),extname=path.extname(url.value);if(!path.isFake&&pathes.length&&isProbablyModulePath(url.value))var inModule=pathes.some(function(item){filename=path.join(item,url.value);try{if(stat=fs.statSync(filename),stat.isFile())return!0}catch(e){}});if(!inModule)if(/^\/|:\//.test(url.value)){var filename=url.value;if(/^(https|http):\/\//.test(filename))var isRemote=!0}else{var filename,base=path.dirname(this.options.filename);/^(https|http):\/\//.test(base)&&sysUrl?(filename=sysUrl.resolve(this.options.filename,url.value),isRemote=!0):filename=path.join(base,url.value)}filename+=extname?"":".mcss";var options=_.extend({filename:filename},this.options),self=this,_requires=this.get("_requires");_requires&&~_requires.indexOf(filename)&&this.error('it is seems file:"'+filename+'" and file: "'+this.get("filename")+'" has Circular dependencies',url.lineno),options._requires=_requires?_requires.concat([this.get("filename")]):[this.get("filename")];var pr=promise(),imports=this.get("imports"),text=imports[filename];return"string"==typeof text||isRemote&&(text=remoteFileCache.get(filename))?new Parser(options).parse(text).always(pr):io.get(filename).done(function(text){isRemote?remoteFileCache.set(filename,text):imports[filename]=text,new Parser(options).parse(text).always(pr).fail(pr)}).fail(function(){var err=new error.SyntaxError(filename+" FILE NOT FOUND",url.lineno,self.options);pr.reject(err)}),pr.done(function(ast){node.filename=filename})},_removePrefix:function(str){return str.replace(/^-\w+-/,"")}},options.mixTo(Parser)},3:function(require,module,exports,global){function createToken(type,value,lineno){var token="object"==typeof type?type:{type:type,value:value};return token.lineno=lineno,token}function Tokenizer(options){this.options=options||{},this.options.ignoreComment=!0}var util=require("4"),error=(require("8"),require("a")),$=([].slice,function(){var table={};return function(name,pattern){if(!pattern){if(/^[a-zA-Z]+$/.test(name))return table[name];pattern=name,name=null}return"string"!=typeof pattern&&(pattern=String(pattern).slice(1,-1)),pattern=pattern.replace(/\{([a-zA-Z]+)}/g,function(all,name){var p=table[name];if(!p)throw Error('no register pattern "'+name+'" before');var pstart=p.charAt(0),pend=p.charAt(p.length-1);return"["===pstart&&"]"===pend||"("===pstart&&")"===pend||(p="(?:"+p+")"),p}),name&&(table[name]=pattern),new RegExp(pattern)}}()),toAssert2=util.makePredicate;exports.tokenize=function(input,options){return new Tokenizer(options).tokenize(input)},exports.Tokenizer=Tokenizer,exports.$=$,exports.createToken=createToken;var isUnit=toAssert2("% em ex ch rem vw vh vmin vmax cm mm in pt pc px deg grad rad turn s ms Hz kHz dpi dpcm dppx"),isPseudoClassWithParen=toAssert2("current local-link nth-child nth-last-child nth-of-type nth-last-of-type nth-match nth-last-match column nth-column nth-last-column lang matches not",!0),MAX_ALLOWED_CODEPOINT=parseInt("10FFFF",16),$rules=(parseInt("FFFD",16),[]),$links={},addRules=function(rules){$rules=$rules.concat(rules);for(var rule,reg,state,link,i=0;i<$rules.length;i++)rule=$rules[i],reg="string"!=typeof rule.regexp?String(rule.regexp).slice(1,-1):rule.regexp,~reg.indexOf("^(?")||(rule.regexp=new RegExp("^(?:"+reg+")")),state=rule.state||"init",link=$links[state]||($links[state]=[]),link.push(i);return this};$("nl",/\r\n|[\r\f\n]/),$("w",/[ \t\r\n\f]/),$("d",/[0-9]/),$("escape",/\\[0-9a-f]{1,6}/),$("nmchar",/[_-\w\u00A1-\uFFFF]|{escape}/),$("nmstart",/[_a-zA-Z\u00A1-\uFFFF]|{escape}/),$("ident",/-?{nmstart}{nmchar}*/),addRules([{regexp:/\/\*([^\x00]+?)\*\/|\/\/([^\n\r]*)/,action:function(yytext,mcomment,scomment){var isSingle=void 0===mcomment;this.options.comment&&this.options.comment({type:isSingle?"singleline":"multiline",content:isSingle?scomment:mcomment})}},{regexp:$(/(url|url\-prefix|domain|regexp){w}*\((['"])?{w}*([^\r\n\f]*?)\2{w}*\)/),action:function(yytext,name,quote,url){return this.yyval=url,"url"===name?"URL":{type:"FUNCTION",value:name,args:[{type:"STRING",value:url}]}}},{regexp:$(/(?:\$?-?[_A-Za-z][-_\w]*)(?=\()/),action:function(yytext){return this.yyval=yytext,"FUNCTION"}},{regexp:/\$(-?[_A-Za-z][-_\w]*)/,action:function(yytext,value){return this.yyval=yytext,"VAR"}},{regexp:$(/{ident}/),action:function(yytext){return"false"===yytext||"true"===yytext?(this.yyval="false"!==yytext,"BOOLEAN"):(this.yyval=yytext,"null"===yytext?"NULL":"TEXT")}},{regexp:$(/(-?(?:{d}*\.{d}+|{d}+))(\w*|%)?/),action:function(yytext,value,unit){return unit&&!isUnit(unit)&&this.error('Unexcept unit: "'+unit+'"'),{type:"DIMENSION",value:parseFloat(value),unit:unit}}},{regexp:$(/\.({nmchar}+)/),action:function(yytext){return this.yyval=yytext,"CLASS"}},{regexp:/@(-?[_A-Za-z][-_\w]*)/,action:function(yytext,value){return this.yyval=value,"AT_KEYWORD"}},{regexp:$(/!{w}*important/),action:function(yytext){return"IMPORTANT"}},{regexp:$(":([-_a-zA-Z]+)(?:\\(([^\\(\\)]*|(?:\\([^\\)]+\\))+)\\))"),action:function(yytext,value){return!(~yytext.indexOf("(")&&!isPseudoClassWithParen(value))&&(this.yyval=yytext,"PSEUDO_CLASS")}},{regexp:$("::({nmchar}+)"),action:function(yytext){return this.yyval=yytext,"PSEUDO_ELEMENT"}},{regexp:$("\\[\\s*(?:{nmchar}+)\\s*(?:([*^$|~!]?=)\\s*['\"]?(?:[^'\"\\[]*)['\"]?)?\\s*\\]"),action:function(yytext){return this.yyval=yytext,"ATTRIBUTE"}},{regexp:$(/#{nmchar}+/),action:function(yytext,value){return this.yyval=yytext,"HASH"}},{regexp:/(['"])([^\r\n\f]*?)\1/,action:function(yytext,quote,value){return this.yyval=value||"","STRING"}},{regexp:$(/{w}*(&&|\|\||[\*\$\^~\|>=<!?]?=|\.\.\.|[\{;,><]){w}*/),action:function(yytext,punctuator){return punctuator}},{regexp:$("WS",/{w}+/),action:function(){return"WS"}},{regexp:/($|#\{|:|::|[~!#()\[\]&\.]|[\}%\-+*\/])/,action:function(yytext,punctuator){return punctuator?punctuator:"EOF"}},{regexp:$(/\\([0-9a-fA-F]{1,6})/),action:function(yytext,value){var hex=parseInt(value,16);return hex>MAX_ALLOWED_CODEPOINT&&(hex="�"),hex="\\"+hex.toString(16),this.yyval=hex,"TEXT"}}]),Tokenizer.prototype={constructor:Tokenizer,tokenize:function(input){return this.input=input,this.remained=this.input,this.length=this.input.length,this.lineno=1,this.states=["init"],this.state="init",this.pump()},lex:function(){var token=this.next();return"undefined"!=typeof token?token:this.lex()},pump:function(){for(var t,tokens=[],i=0;(t=this.lex())&&(i++,tokens.push(t),"EOF"!=t.type););return tokens},next:function(){var tmp,action,rule,token,tokenType,lines,state=this.state,link=$links[state];this.yyval=null;for(var len=link.length,i=0;i<len;i++){var rule=$rules[link[i]];if(tmp=this.remained.match(rule.regexp)){if(action=rule.action,tokenType=action.apply(this,tmp),tokenType===!1)continue;break}}return tmp?(lines=tmp[0].match(/(?:\r\n|[\n\r\f]).*/g),lines&&(this.lineno+=lines.length),this.remained=this.remained.slice(tmp[0].length),tokenType&&(token=createToken(tokenType,this.yyval,this.lineno),"WS"===tokenType?(this._preIsWS&&(token=void 0),this._preIsWS=!0):this._preIsWS=!1),token):void this.error("Unexpect token start")},pushState:function(condition){this.states.push(condition),this.state=condition},popState:function(){this.states.pop(),this.state=this.states[this.states.length-1]},error:function(message){var line=this.lineno,err=new error.SyntaxError(message,line,this.options);throw err.column=this._getColumn(),err},_getColumn:function(){for(var newline=/^[\n\f\r]/,n=this.length-this.remained.length,column=0;n--&&!(newline.test(this.input.charAt(n))&&n>=0);)column++;return column}}},4:function(require,module,exports,global){function returnTrue(){return!0}var _={},slice=[].slice,fs=null,mkdirp=require("5"),path=require("6"),tpl=require("7");tpl('the {i} argument passed to this function only accept {accept}, but got "{type}"'),Function.prototype,Number.prototype;_.accept=function(fn,list){if(list&&list.length){var tlist=list.map(function(item){return item?"function"==typeof item?item:_.makePredicate(item):returnTrue});return function(){for(var args=_.slice(arguments),i=args.length;i--;)if(args[i]){var type=args[i].type,test=tlist[i];if(test&&!test(type)){var message="invalid param or operand : "+type;if(!this.error)throw Error(message);this.error(message,args[0].lineno)}}return fn.apply(this,arguments)}}},_.msetter=function(fn){return function(key,value){if("object"==typeof key){var args=_.slice(arguments,1);for(var i in key)fn.apply(this,[i,key[i]].concat(args));return this}return fn.apply(this,arguments)}},_.limit=function(num,min,max){return Math.min(max,Math.max(min,num))},_.makePredicate=function(words,prefix){function compareTo(arr){if(1==arr.length)return f+="return str === '"+arr[0]+"';";f+="switch(str){";for(var i=0;i<arr.length;++i)f+="case '"+arr[i]+"':";f+="return true}return false;"}"string"==typeof words&&(words=words.split(" "));var f="",cats=[];out:for(var i=0;i<words.length;++i){for(var j=0;j<cats.length;++j)if(cats[j][0].length==words[i].length){cats[j].push(words[i]);continue out}cats.push([words[i]])}if(cats.length>3){cats.sort(function(a,b){return b.length-a.length}),f+="var prefix = "+(prefix?"true":"false")+";if(prefix) str = str.replace(/^-(?:\\w+)-/,'');switch(str.length){";
for(var i=0;i<cats.length;++i){var cat=cats[i];f+="case "+cat[0].length+":",compareTo(cat)}f+="}"}else compareTo(words);return new Function("str",f)},_.isNotAcceptByBlock=_.makePredicate("rgba dimension string boolean text null url values valueslist"),_.makePredicate2=function(words){return"string"!=typeof words&&(words=words.join(" ")),function(word){return~words.indexOf(word)}},_.perf=function(fn,times,args){for(var date=+new Date,i=0;i<times;i++)fn.apply(this,args||[]);return+new Date-date},_.extend=function(o1,o2,override){for(var j in o2)"_"!==j.charAt(0)&&(null==o1[j]||override)&&(o1[j]=o2[j]);return o1},_.copy=function(obj,keys){var res={};return keys.forEach(function(key){res[key]=obj[key]}),res},_.debugger=1,_.log=function(){_.debugger<3||console.log.apply(console,arguments)},_.warn=function(){_.debugger<2||console.warn.apply(console,arguments)},_.error=function(){_.debugger<1||console.error.apply(console,arguments)},_.uuid=function(t){var _uid=1;return t=t||"",function(){return t+_uid++}},_.writeFile=function(fullpath,data,callback){function write(cb){fs.writeFile(fullpath,data,cb)}write(function(error){return error?void mkdirp(path.dirname(fullpath),493,function(error){return error?callback(error):void write(function(error){callback(error,fullpath,data)})}):callback(null,fullpath,data)})},_.flatten=function(array){var res=[];return _.slice(array).forEach(function(item,index){item&&(Array.isArray(item)?res=res.concat(_.flatten(item)):res.push(item))}),res},_.throttle=function(func,wait,immediate){var context,args,result,timeout=null,previous=0,later=function(){previous=new Date,timeout=null,result=func.apply(context,args)};return function(){var now=new Date;previous||immediate!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||(timeout=setTimeout(later,remaining)),result}},_.restrict=function(func,interval){var previous;return function(){var now=+new Date;(!previous||now-previous>interval)&&func.apply(this,arguments),previous=now}},_.uid=_.uuid(),_.merge=function(list,ast){if(ast){var type=ast.type;if("block"===type||"stylesheet"===type)return _.merge(list,ast.list);if(Array.isArray(ast))for(var i=0,len=ast.length;i<len;i++)_.merge(list,ast[i]);else ast.type&&!_.isNotAcceptByBlock(ast.type.toLowerCase())&&list.push(ast)}},_.typeOf=function(obj){return null==obj?String(obj):Object.prototype.toString.call(obj).slice(8,-1).toLowerCase()},_.slice=function(arr,start,last){return slice.call(arr,start,last)},_.watch=function(file,callback){var isWin="win32"===process.platform;isWin?fs.watch(file,function(event){"change"===event&&callback(file)}):fs.watchFile(file,{interval:200},function(curr,prev){curr.mtime>prev.mtime&&callback(file)})},_.round=function(num,percision){return percision||(percision=Math.pow(10,6)),Math.round(num*percision)/percision},_.cache=function(max){var keys=[],cache={};return{set:function(key,value){return keys.length>this.length&&delete cache[keys.shift()],void 0==cache[key]&&keys.push(key),cache[key]=value,value},get:function(key){return void 0===key?cache:cache[key]},length:max,len:function(){return keys.length}}},module.exports=_},5:function(require,module,exports,global){function mkdirP(p,mode,f,made){"function"!=typeof mode&&void 0!==mode||(f=mode,mode=511&~process.umask()),made||(made=null);var cb=f||function(){};"string"==typeof mode&&(mode=parseInt(mode,8)),p=path.resolve(p),fs.mkdir(p,mode,function(er){if(!er)return made=made||p,cb(null,made);switch(er.code){case"ENOENT":mkdirP(path.dirname(p),mode,function(er,made){er?cb(er,made):mkdirP(p,mode,cb,made)});break;default:fs.stat(p,function(er2,stat){er2||!stat.isDirectory()?cb(er,made):cb(null,made)})}})}var path=null,fs=null;module.exports=mkdirP.mkdirp=mkdirP.mkdirP=mkdirP,mkdirP.sync=function sync(p,mode,made){void 0===mode&&(mode=511&~process.umask()),made||(made=null),"string"==typeof mode&&(mode=parseInt(mode,8)),p=path.resolve(p);try{fs.mkdirSync(p,mode),made=made||p}catch(err0){switch(err0.code){case"ENOENT":made=sync(path.dirname(p),mode,made),sync(p,mode,made);break;default:var stat;try{stat=fs.statSync(p)}catch(err1){throw err0}if(!stat.isDirectory())throw err0}}return made}},6:function(require,module,exports,global){function dirname(path){return path.match(DIRNAME_RE)[0]}function normalize(path){for(path=path.replace(DOT_RE,"/"),path=path.replace(MULTIPLE_SLASH_RE,"$1/");path.match(DOUBLE_DOT_RE);)path=path.replace(DOUBLE_DOT_RE,"/");return path}function join(url,url2){var args=slice.call(arguments),res=args.reduce(function(u1,u2){return u1+"/"+u2});return normalize(res)}function extname(url){var res=url.match(/(\.\w+)[^\/]*$/);return res&&res[1]?res[1]:""}function isAbsolute(url){return/^\/|:\//.test(url)}var syspath=null,slice=[].slice;if(syspath)module.exports=syspath;else{exports.fake=!0,exports.join=join,exports.normalize=normalize,exports.dirname=dirname,exports.extname=extname,exports.isAbsolute=isAbsolute;var slice=[].slice,DIRNAME_RE=/[^?#]*\//,DOT_RE=/\/\.\//g,MULTIPLE_SLASH_RE=/(:\/)?\/\/+/g,DOUBLE_DOT_RE=/\/[^\/]+\/\.\.\//}},7:function(require,module,exports,global){function tpl(template){function get(p){return"."==p?"":"."+p}function replace(str){for(var codes=[],pre=str;str=str.replace(/^\{\s*([\.-\w]*?)\s*}|\{#([\.-\w]*?)}([\s\S]*?)\{\/\2}|([^{]*)/,function(all,tagname,blockname,blockcontent,raw){if(raw)codes.push(['s+="',raw,'";'].join(""));else if(tagname)codes.push(["s+=vars",get(tagname),'||"";'].join(""));else if(blockname){var k=++i;codes.push(["var o",k,"=vars",get(blockname),";","o",k," = o",k," instanceof Array? o",k,":[o",k,"]",";for(var i",k,"=0;i",k,"<o",k,".length;i",k,"++)","{var tmp",k,"=vars; vars=o",k,"[i",k,"]; ",replace(blockcontent),"vars=tmp",k,"}"].join(""))}return""});){if(str===pre)throw"unexpect at \n"+str;pre=str}return codes.join("")}var i=0;return new Function("vars",['var s = "";',replace(template.replace(/\n/g,"\\n").replace(/"/g,'\\"')),"return s;"].join(""))}module.exports=tpl},8:function(require,module,exports,global){function Stylesheet(list){this.type="stylesheet",this.list=list||[]}function SelectorList(list,lineno){this.type="selectorlist",this.list=list||[],this.lineno=lineno}function ComplexSelector(string,interpolations){this.type="complexselector",this.string=string,this.interpolations=interpolations||[]}function RuleSet(selector,block,abstract){this.type="ruleset",this.selector=selector,this.block=block,this.ref=[],this.abstract=abstract||!1}function Block(list){this.type="block",this.list=list||[]}function Declaration(property,value,important){this.type="declaration",this.property=property,this.value=value,this.important=important||!1}function Values(list){this.type="values",this.list=list||[]}function ValuesList(list,lineno){this.type="valueslist",this.list=list||[],this.lineno=lineno}function Unknown(name){this.type="unknown",this.name=name}function Assign(name,value,mode){this.type="assign",this.name=name,this.value=value,this.mode=void 0===mode?1:mode}function Func(params,block,name){this.type="func",this.params=params||[],this.block=block}function Param(name,dft,rest){this.type="param",this.name=name,this.default=dft,this.rest=rest||!1}function Extend(selector){this.type="extend",this.selector=selector}function Module(name,block){this.type="module",this.block=block}function Pointer(name,key){this.type="pointer",this.name=name,this.key=key}function Import(url,queryList,stylesheet){this.type="import",this.url=url,this.queryList=queryList||[],this.stylesheet=stylesheet}function IfStmt(test,block,alt){this.type="if",this.test=test,this.block=block,this.alt=alt}function ForStmt(element,index,list,block,isIn,by){this.type="for",this.element=element,this.index=index,this.list=list,this.block=block,this.isIn=isIn||!1,this.by=by}function ReturnStmt(value){this.type="return",this.value=value}function CompoundIdent(list){this.type="compoundident",this.list=list||[]}function Dimension(value,unit){this.type="dimension",this.value=value,this.unit=unit}function Operator(op,left,right){this.type="operator",this.op=op,this.left=left,this.right=right}function Range(left,right){this.type="range",this.left=left,this.right=right}function Unary(value,op){this.type="unary",this.value=value,this.op=op}function Call(name,args,named,lineno){this.type="call",this.name=name,this.args=args||[],this.named=named,this.lineno=lineno}function FontFace(block){this.type="fontface",this.block=block}function Media(queryList,block){this.type="media",this.queryList=queryList||[],this.block=block}function MediaQuery(type,expressions){this.type="mediaquery",this.mediaType=type,this.expressions=expressions||[]}function MediaExpression(feature,value){this.type="mediaexpression",this.feature=feature,this.value=value}function Keyframes(name,list){this.type="keyframes",this.name=name,this.block=list}function Keyframe(steps,block){this.type="keyframe",this.steps=steps||steps,this.block=block}function Page(selector,block){this.type="page",this.selector=selector,this.block=block}function Debug(value){this.type="debug",this.value=value}function Directive(name,value,block){this.type="directive",this.name=name,this.value=value,this.block=block}function Range(start,end){this.type="range",this.start=start,this.end=end}var _=require("4"),splice=[].splice,tk=require("3"),isPrimary=_.makePredicate("rgba dimension string boolean text null url");Stylesheet.prototype.clone=function(){var clone=new Stylesheet;return clone.list=cloneNode(this.list),clone},Stylesheet.prototype.exclude=function(){for(var item,res=[],list=this.list,len=list.length;len--;)item=list[len],"media"===item.type&&res.unshift(list.splice(len,1)[0]);return res},Stylesheet.prototype.abstract=function(){for(var list=this.list,i=list.length;i--;){var ruleset=list[i];ruleset&&"ruleset"==ruleset.type&&(ruleset.abstract=!0)}return this},SelectorList.prototype.clone=function(){var clone=new SelectorList(cloneNode(this.list));return clone},SelectorList.prototype.len=function(){return this.list.length},exports.selectorlist=function(list,lineno){return new SelectorList(list,lineno)},ComplexSelector.prototype.clone=function(){var clone=new ComplexSelector(this.string,cloneNode(this.interpolations));return clone},RuleSet.prototype.addRef=function(ruleset){var alreadyHas=this.ref.some(function(item){return ruleset===item});alreadyHas||this.ref.push(ruleset)},RuleSet.prototype.extend=function(){},RuleSet.prototype.getSelectors=function(){if(1==this.selector._compute)return this.selector.list;var plist,selectors=this.selector.list;return this.parent&&(plist=this.parent.getSelectors())&&plist.length&&(selectors=this._concatSelector(selectors,plist)),this.parent||this.selector.list.forEach(function(selector){selector.string=selector.string.replace(/&/g,"")}),this.ref.length&&(this.ref.forEach(function(ruleset){selectors=selectors.concat(ruleset.getSelectors())}),this.ref=[]),this.selector.list=selectors,this.selector._compute=!0,selectors};var comboSplit=/\s*[~+>\s]\s*/;RuleSet.prototype._concatSelector=function(slist,plist){if(!plist.length||!slist.length)return[];var sstring,pstring,rstring,s,p,slen=slist.length,plen=plist.length,res=[];for(p=0;p<plen;p++)for(pstring=plist[p].string,s=0;s<slen;s++){if(sstring=slist[s].string,~sstring.indexOf("&"))rstring=sstring.replace(/&/g,pstring);else if(~sstring.indexOf("%")){var index=pstring.search(comboSplit);rstring=sstring.replace(/([^0-9]|^)%/g,function(all,a){return(a||"")+(~index?pstring.slice(index):"")})}else rstring=pstring+" "+sstring;res.push(new exports.ComplexSelector(rstring))}return res},RuleSet.prototype.clone=function(){var clone=new RuleSet(cloneNode(this.selector),cloneNode(this.block),this.abstract);return clone},Block.prototype.clone=function(){var clone=new Block(cloneNode(this.list));return clone},Block.prototype.exclude=function(isMedia){var item,res=[],list=this.list;if(isMedia)var declarations=[];for(var len=list.length;len--;)item=list[len],isMedia?("media"===item.type&&res.unshift(list.splice(len,1)[0]),"declaration"===item.type&&declarations.unshift(list.splice(len,1)[0])):"declaration"!==item.type&&res.unshift(list.splice(len,1)[0]);return declarations&&declarations.length&&res.unshift(declarations),res},Block.prototype.abstract=function(){for(var list=this.list,i=list.length;i--;){var ruleset=list[i];ruleset&&"ruleset"==ruleset.type&&(ruleset.abstract=!0)}return this},Declaration.prototype.clone=function(name){var clone=new Declaration(cloneNode(this.property),cloneNode(this.value),this.important);return clone},Values.prototype.clone=function(){var clone=new Values(cloneNode(this.list));return clone},Values.prototype.flatten=function(){for(var value,list=this.list,i=list.length;i--;)value=list[i],"values"==value.type&&splice.apply(this,[i,1].concat(value.list));return this},exports.values=function(list,lineno){var node=new Values(list);return node.lineno=lineno,node},ValuesList.prototype.clone=function(){var clone=new ValuesList(cloneNode(this.list),this.lineno);return clone},ValuesList.prototype.flatten=function(){for(var values,list=this.list,i=list.length;i--;)values=list[i],"valueslist"==values.type&&splice.apply(list,[i,1].concat(values.list));return this},ValuesList.prototype.first=function(){return this.list[0].list[0]},exports.valueslist=function(list,lineno){return new ValuesList(list,lineno)},Unknown.prototype.clone=function(){var clone=new Unknown(this.name);return clone},Assign.prototype.clone=function(name){var clone=new Assign(this.name,cloneNode(this.value),this.mode);return clone},Func.prototype.clone=function(){var clone=new Func(cloneNode(this.params),this.block);return clone},Param.prototype.clone=function(){var clone=new Param(this.name,cloneNode(this.default),this.rest);return clone},Extend.prototype.clone=function(){var clone=new Extend(this.selector);return clone},exports.extend=function(selector){return new Extend(selector)},Module.prototype.clone=function(){var clone=new Module(this.name,cloneNode(this.block));return clone},Pointer.prototype.clone=function(){var clone=new Pointer(this.name,this.key);return clone},Import.prototype.clone=function(){var clone=new Import(this.url,this.queryList,this.stylesheet);return clone},IfStmt.prototype.clone=function(){var clone=new IfStmt(cloneNode(this.test),cloneNode(this.block),cloneNode(this.alt));return clone},ForStmt.prototype.clone=function(){var clone=new ForStmt(this.element,this.index,cloneNode(this.list),cloneNode(this.block),this.isIn,cloneNode(this.by));return clone.isIn=this.isIn,clone},ReturnStmt.prototype.clone=function(){var clone=new ReturnStmt(cloneNode(this.value));return clone},CompoundIdent.prototype.clone=function(){var clone=new CompoundIdent(cloneNode(this.list));return clone},CompoundIdent.prototype.toString=function(){return this.list.join("")},Dimension.prototype.clone=function(){var clone=new Dimension(this.value,this.unit);return clone},Dimension.prototype.toString=function(){return""+this.value+(this.unit||"")},Operator.prototype.clone=function(){var clone=new Operator(this.op,cloneNode(this.left),cloneNode(this.right));return clone},Operator.prototype.toBoolean=function(){},Range.prototype.clone=function(){var clone=new Range(cloneNode(this.left),cloneNode(this.right));return clone},Unary.prototype.clone=function(){var clone=new Unary(cloneNode(this.value),this.op);return clone},Call.prototype.clone=function(){var clone=new Call(this.name,cloneNode(this.args),this.named);return clone},exports.call=function(name,args,named,lineno){var node=new Call(name,args,named,lineno);return node},FontFace.prototype.clone=function(){var clone=new FontFace(param);return clone},Media.prototype.clone=function(){var clone=new Media(cloneNode(this.queryList),cloneNode(this.block));return clone},MediaQuery.prototype.clone=function(){var clone=new MediaQuery(this.mediaType,cloneNode(this.expressions));return clone},MediaQuery.prototype.equals=function(media){var test,exp,expressions=this.expressions,len=expressions.length;if(!media)return!1;if(this.mediaType!==media.mediaType)return!1;if(len!==media.length)return!1;for(;len--;)exp=expressions[len-1],test=media.expressions.some(function(exp2){return exp.equals(exp2)})},MediaExpression.prototype.clone=function(){var clone=new MediaExpression(cloneNode(this.feature),cloneNode(this.value));return clone},MediaExpression.prototype.equals=function(exp2){return this.feature==exp2.feature&&this.value===exp2.feature},Keyframes.prototype.clone=function(){var clone=new Keyframes(cloneNode(this.name),cloneNode(this.block));return clone.fullname=this.fullname,clone},Keyframe.prototype.clone=function(){var clone=new Keyframe(cloneNode(this.steps),cloneNode(this.block));return clone},Page.prototype.clone=function(){var clone=new Page(this.selector,cloneNode(this.block));return clone},Debug.prototype.clone=function(){var clone=new Debug(cloneNode(this.value));return clone},Directive.prototype.clone=function(){var clone=new Directive(this.name,cloneNode(this.value),cloneNode(this.block));return clone.fullname=this.fullname,clone},Range.prototype.clone=function(){var clone=new Range(cloneNode(this.start),cloneNode(this.end));return clone.lineno=this.lineno,clone},exports.range=function(start,end,lineno){var node=new Range(start,end);return node.lineno=lineno,node},exports.directive=function(name,value,block){return new Directive(name,value,block)},exports.Stylesheet=Stylesheet,exports.SelectorList=SelectorList,exports.ComplexSelector=ComplexSelector,exports.RuleSet=RuleSet,exports.Block=Block,exports.Declaration=Declaration,exports.ValuesList=ValuesList,exports.Values=Values,exports.Unknown=Unknown,exports.Func=Func,exports.Param=Param,exports.Extend=Extend,exports.IfStmt=IfStmt,exports.ForStmt=ForStmt,exports.ReturnStmt=ReturnStmt,exports.Module=Module,exports.Debug=Debug,exports.Pointer=Pointer,exports.Range=Range,exports.Import=Import,exports.Page=Page,exports.Directive=Directive,exports.Color=require("9"),exports.Unary=Unary,exports.Assign=Assign,exports.Call=Call,exports.Operator=Operator,exports.CompoundIdent=CompoundIdent,exports.Media=Media,exports.MediaQuery=MediaQuery,exports.MediaExpression=MediaExpression,exports.Keyframes=Keyframes,exports.Keyframe=Keyframe,exports.null=function(lineno){return{type:"NULL",value:"null",lineno:lineno}},exports.token=function(type,value,lineno){return{type:type,value:value,lineno:lineno}},exports.inspect=function(node){return node.type?node.type.toLowerCase():null};var cloneNode=exports.cloneNode=function(node){if(!node)return node;if(node.clone){var clone_node=node.clone();return clone_node.lineno=node.lineno,clone_node}if(Array.isArray(node))return node.map(cloneNode);if(node.type){var res={type:node.type,value:node.value,lineno:node.lineno};return"DIMENSION"===node.type&&(res.unit=node.unit),res}if("object"!=typeof node)return node;throw _.error(node),Error('con"t clone node')};exports.toStr=function(ast){if(!ast)return"";switch(ast.type){case"TEXT":case"BOOLEAN":case"NULL":return String(ast.value);case"DIMENSION":var value=""+_.round(ast.value)+(ast.unit?ast.unit:"");return value;case"STRING":return ast.value;case"color":return ast.toCSS();case"func":return"";case"values":return ast.list.map(function(item){return exports.toStr(item)}).join(" ");case"valueslist":return ast.list.map(function(item){return exports.toStr(item)}).join(",");case"call":return ast.name+"("+ast.args.map(exports.toStr).join(",")+")";case"selectorlist":return ast.list.map(function(selector){return selector.string}).join(",");default:return ast.value}},exports.toBoolean=function(node){if(!node)return!1;var type=node.type;switch(type){case"DIMENSION":return 0!=node.value;case"STRING":case"TEXT":return 0!==node.value.length;case"BOOLEAN":return node.value===!0;case"NULL":return!1;case"valueslist":case"values":return node.list.length>0;case"color":return!0;case"func":return!0}},exports.isPrimary=isPrimary,exports.isRelationOp=_.makePredicate("== >= <= < > !="),exports.convert=function(primary){var tType,type=_.typeOf(primary);switch(type){case"string":tType="STRING";break;case"boolean":tType="BOOLEAN";break;case"number":tType="DIMENSION";break;case"undefined":case"null":tType="NULL";break;case"object":return primary}return tType?tk.createToken(tType,primary):primary}},9:function(require,module,exports,global){function Color(channels,alpha,lineno){if(this.type="color","string"==typeof channels){var string="#"===channels.charAt(0)?channels.slice(1):channels;if(6===string.length)channels=[parseInt(string.substr(0,2),16),parseInt(string.substr(2,2),16),parseInt(string.substr(4,2),16)];else{var r=string.substr(0,1),g=string.substr(1,1),b=string.substr(2,1);channels=[parseInt(r+r,16),parseInt(g+g,16),parseInt(b+b,16)]}}this[0]=channels[0],this[1]=channels[1],this[2]=channels[2],Color.limit(this),this.alpha=null==alpha?1:alpha,this.lineno=lineno}var _=require("4"),c=Color.prototype;c.toHSL=function(){return Color.rgb2hsl(this)},c.toCSS=function(argb){var r=Math.round(this[0]),g=Math.round(this[1]),b=Math.round(this[2]);if(null==this.alpha||1===this.alpha||argb){var rs=r.toString(16),gs=g.toString(16),bs=b.toString(16),as=Math.floor(255*this.alpha).toString(16);return 1===rs.length&&(rs="0"+rs),1===gs.length&&(gs="0"+gs),1===bs.length&&(bs="0"+bs),1===as.length&&(as="0"+as),argb||rs[0]!=rs[1]||gs[0]!=gs[1]||bs[0]!=bs[1]||(gs=gs[0],bs=bs[0],rs=rs[0]),"#"+(1==this.alpha?"":as)+rs+gs+bs}return"rgba("+r+","+g+","+b+","+this.alpha+")"},c.clone=function(){return new Color(this,this.alpha,this.lineno)},Color.rgb2hsl=function(rv,hv){hv=hv||[];var h,s,d,r=rv[0]/255,g=rv[1]/255,b=rv[2]/255,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max==min)h=0,s=0;else{var d=max-min;switch(s=l>=.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return hv[0]=360*h,hv[1]=100*s,hv[2]=100*l,hv},Color.hsl2rgb=function(hv,rv){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}rv=rv||[];var r,g,b,h=hv[0]/360,s=hv[1]/100,l=hv[2]/100;if(0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return rv[0]=255*r,rv[1]=255*g,rv[2]=255*b,rv},Color.limit=function(values){values[0]=_.limit(values[0],0,255),values[1]=_.limit(values[1],0,255),values[2]=_.limit(values[2],0,255),values.alpha&&(values.alpha=_.limit(values.alpha,0,1))},Color.hsl=function(channels,a){return new Color(Color.hsl2rgb(channels),a)},Color.maps={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},module.exports=Color},a:function(require,module,exports,global){function McssError(message,line,options){this.message=message,this.line=line,this.filename=options.filename,this.source=options.imports[options.filename],Error.captureStackTrace(this,McssError)}function SyntaxError(message,line,options){this.message=message,this.line=line,this.filename=options.filename,this.source=options.imports[options.filename],Error.captureStackTrace(this,SyntaxError)}function getLineNum(line){return("           "+line).slice(-5)+"."}var tpl=require("7"),color=require("b");McssError.prototype.__proto__=Error.prototype,McssError.prototype.name="McssError",SyntaxError.prototype.__proto__=Error.prototype,SyntaxError.prototype.name="SyntaxError",exports.McssError=McssError,exports.SyntaxError=SyntaxError,exports.isMcssError=function(error){return error instanceof SyntaxError||error instanceof McssError},exports.tpls={unexcept:tpl("expcept {expcept} but got {type}"),syntaxerror:tpl("expcept {expcept} but got {type}"),tperror:tpl("expcept {expcept} but got {type}"),outportError:tpl(["{message}\n","at {filename} ({line}: {column})","{#lines}","{mark}|{index} {line}","{/lines}"].join(""))},exports.format=function(error){if(!exports.isMcssError(error))return error;for(var source=error.source,lines=source.split(/\r\n|[\r\f\n]/),message=(error.pos,error.message),line=error.line||1,column=error.column||0,start=Math.max(1,line-5),end=Math.min(lines.length,line+4),res=[color(error.name+":"+message,"red",null,"bold"),"\tat ("+color(error.filename,"yellow")+" : "+line+")"],i=start;i<=end;i++){var info,cur=lines[i-1];info=i===line?color(">>","red",null,"bold")+getLineNum(i)+"| "+cur.slice(0,column)+color(cur.slice(column),"white","red"):"  "+getLineNum(i)+"| "+cur,res.push(info)}return error.message=res.join("\n"),error}},b:function(require,module,exports,global){var colorToAnsi,colorify;colorToAnsi={style:{normal:0,bold:1,underline:4,blink:5,strike:9},fore:{black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,brightBlack:90,brightRed:91,brightGreen:92,brightYellow:99,brightBlue:94,brightMagenta:95,brightCyan:96,brightWhite:97},back:{black:40,red:41,green:42,yellow:43,blue:44,magenta:45,cyan:46,white:47,brightBlack:100,brightRed:101,brightGreen:102,brightYellow:103,brightBlue:104,brightMagenta:105,brightCyan:106,brightWhite:107}},module.exports=colorify=function(text,fore,back,style){if(global.document&&9===global.document.nodeType)return text;var attrCode,backCode,foreCode,octpfx,reset,result,suffix,_ref;return null==style&&(style="normal"),"string"!=typeof fore&&(_ref=fore,fore=_ref.fore,back=_ref.back,style=_ref.style),result=[],(foreCode=colorToAnsi.fore[fore]||parseInt(fore))&&result.push(foreCode),(backCode=colorToAnsi.back[back]||parseInt(back))&&result.push(backCode),(attrCode=colorToAnsi.style[style]||parseInt(style))&&result.push(attrCode),suffix=result.join(";"),octpfx="",reset=""+octpfx+"[0m",""+octpfx+"["+suffix+"m"+text+reset}},c:function(require,module,exports,global){function Directive(){}var _=module.exports=Directive;_.addDirective=function(name,def){},_.getDirective=function(name){}},d:function(require,module,exports,global){var _=require("4"),tree=require("8"),formats={d:function(value){return parseInt(value.value,10).toString(10)},f:function(value){return parseFloat(value.value,10).toString(10)},x:function(value){return parseInt(value.value,10).toString(16)},X:function(value){return parseInt(value.value,10).toString(16).toUpperCase()},s:function(value){return tree.toStr(value)}};module.exports={"+":_.accept(function(left,right){var value=left.value+right.value,unit=left.unit||right.unit;return"DIMENSION"===left.type&&"DIMENSION"===right.type?(left.unit&&right.unit&&left.unit!==right.unit&&_.warn("unmatched unit, forced 2rd unit equal with the 1st one"),{type:left.type,value:value,unit:unit,lineno:left.lineno}):{type:"DIMENSION"===left.type?right.type:left.type,value:tree.toStr(left)+tree.toStr(right),lineno:left.lineno}},["TEXT DIMENSION STRING","TEXT DIMENSION STRING"]),"-":_.accept(function(left,right){var value=left.value-right.value,unit=left.unit||right.unit;return left.unit&&right.unit&&left.unit!==right.unit&&_.warn("unmatched unit, forced 2rd unit equal with the 1st one"),{type:left.type,value:value,unit:unit,lineno:left.lineno}},["DIMENSION","DIMENSION"]),"*":_.accept(function(left,right){var value=left.value*right.value,unit=left.unit||right.unit;return left.unit&&right.unit&&left.unit!==right.unit&&_.warn("unmatched unit, forced 2rd unit equal with the 1st one"),{type:left.type,value:value,unit:unit,lineno:left.lineno}},["DIMENSION","DIMENSION"]),"/":_.accept(function(left,right){if(0===right.value)throw"Divid by zero"+right.lineno;var value=left.value/right.value,unit=left.unit||right.unit;return left.unit&&right.unit&&left.unit!==right.unit&&_.warn("unmatched unit, forced 2rd unit equal with the 1st one"),{type:left.type,value:value,unit:unit}},["DIMENSION","DIMENSION"]),"%":_.accept(function(left,right){if("STRING"===left.type){var values=right.list||[right],index=0,value=left.value.replace(/\%(x|f|s|d|X)/g,function(all,format){var replace=values[index];return replace?(index++,formats[format](replace)):""});return{type:"STRING",value:value,lineno:left.lineno}}if(0===right.value)throw"Divid by zero"+right.lineno;var value=left.value%right.value,unit=left.unit||right.unit;return left.unit&&right.unit&&left.unit!==right.unit&&_.warn("unmatched unit, forced 2rd unit equal with the 1st one"),{type:left.type,value:value,unit:unit,lineno:left.lineno}},["DIMENSION STRING"]),relation:function(left,right,op){var bv,bool={type:"BOOLEAN",lineno:left.lineno},lv=left.value,rv=right.value,lt=left.type,rt=right.type;return lt!==rt?bv=~"STRING TEXT".indexOf(lt)&&~"STRING TEXT".indexOf(rt)?lv!==rv?"!="===op:"=="===op:"!="===op:"DIMENSION"===lt?(lv>rv&&(bv=">"===op||">="===op||"!="===op),lv<rv&&(bv="<"===op||"<="===op||"!="===op),lv===rv&&(bv="=="===op||">="===op||"<="===op)):bv=tree.toStr(left)!==tree.toStr(right)?"!="===op:"=="===op,bool.value=bv,
bool},"&&":function(left,right){var bool=tree.toBoolean(left);return bool?this.walk?this.walk(right):right:left},"||":function(left,right){var bool=tree.toBoolean(left);return bool?left:this.walk?this.walk(right):right}}},e:function(require,module,exports,global){var slice=Array.prototype.slice,isFunction=function(fn){return"function"==typeof fn},typeOf=function(obj){return null==obj?String(obj):Object.prototype.toString.call(obj).slice(8,-1).toLowerCase()},extend=function(o1,o2){for(var i in o2)o2.hasOwnProperty(i)&&(o1[i]=o2[i])},states={PENDING:1,RESOLVED:2,REJECTED:3},Promise=function(){this.state=states.PENDING,this.locked=!1,this.args=[],this.doneCallbacks=[],this.failCallbacks=[],this.progressCallbacks=[]};extend(Promise.prototype,{lock:function(){return this.locked=!0,this},unlock:function(){this.locked=!1;var method={2:"resolve",3:"reject"}[this.state];return method&&this[method].apply(this,this.args),this},notify:function(){if(this.state!==states.PENDING)return this;var fn,i=0;if(this.locked)return this;for(;null!=(fn=this.progressCallbacks[i++]);)fn.apply(this,arguments);return this.parent&&this.parent.sub--,this},reject:function(){if(this.state!==states.PENDING)return this;var fn;this.args=slice.call(arguments);if(this.locked)return this;for(;null!=(fn=this.failCallbacks.shift());)fn.apply(this,arguments);return this.state=states.REJECTED,this},resolve:function(){if(this.state!==states.PENDING)return this;var fn;this.args=slice.call(arguments);if(this.locked)return this;for(;null!=(fn=this.doneCallbacks.shift());)fn.apply(this,arguments);return this.state=states.RESOLVED,this},done:function(callback){return callback instanceof Promise?this.done(function(){var args=slice.call(arguments);callback.resolve.apply(callback,args)}):isFunction(callback)?(this._match(states.RESOLVED,callback)||this.doneCallbacks.push(callback.bind(this)),this):this},fail:function(callback){return callback instanceof Promise?this.fail(function(){var args=slice.call(arguments);callback.reject.apply(callback,args)}):isFunction(callback)?(this._match(states.REJECTED,callback)||this.failCallbacks.push(callback.bind(this)),this):this},progress:function(callback){return isFunction(callback)?(this.progressCallbacks.push(callback),this):this},always:function(callback){return callback?this.done(callback).fail(callback):this},then:function(doneCallback,failCallback){if(!doneCallback)return this;var promise=(new Promise).lock();return this.done(this._wraper(doneCallback,promise)).fail(promise),promise},pipe:function(){return this},promise:function(){return this},_wraper:function(fn,promise){var self=this;return function(){var result=fn.apply(self,arguments);result instanceof Promise&&(extend(promise,result),promise.unlock())}},_match:function(state,callback){return this.state==state&&(callback.apply(this,this.args),!0)}});var promise=module.exports=function(){return new Promise};extend(promise,{when:function(){var promises=slice.call(arguments),whenPromise=new Promise;whenPromise.waiting=promises.length;for(var i=0,len=promises.length;i<len;i++)!function(i){promises[i].done(function(){whenPromise.args[i]="array"==typeOf(promises[i].args[0])?promises[i].args[0]:promises[i].args,--whenPromise.waiting||whenPromise.resolve.apply(whenPromise,whenPromise.args)}),promises[i].fail(function(){whenPromise.reject.apply(whenPromise,promises[i].args)})}(i);return whenPromise},not:function(p){var result=new Promise;return p.done(result.reject.bind(result)).fail(result.resolve.bind(result)),result},or:function(){var promises=slice.call(arguments),not=promise.not,negatedPromises=promises.map(not);return promise.not(promise.when.apply(this,negatedPromises))},isPromise:function(promise){return promise&&promise instanceof Promise}})},f:function(require,module,exports,global){var _=require("4"),API={set:_.msetter(function(name,value){return options=this.options||(this.options={}),options[name]=value,this}),get:function(name){return options=this.options||(this.options={}),options[name]},has:function(name,value){return value?this.get(name)===value:!!this.get(name)},del:function(name){options=this.options||(this.options={}),delete options[name]},add:function(name,item){options=this.options||(this.options={}),options[name]||(options[name]=[]);var container=options[name];return container instanceof Array&&container.push(item),this}};exports.mixTo=function(obj){return obj="function"==typeof obj?obj.prototype:obj,_.extend(obj,API)}},g:function(require,module,exports,global){var Scope=(exports.SymbolTable=function(){},exports.Scope=function(parentScope){this.parentScope=parentScope,this.symtable={},this.isStruct=!1});Scope.prototype={getSpace:function(){return this.symtable},resolve:function(name,first){for(var scope=this;scope;){var symbol=scope.symtable[name];if(symbol)return symbol;if(first)return;scope=scope.parentScope}},define:function(name,value){return this.symtable[name]=value,this},getSymbol:function(name){return this.symtable[name]},getOuterScope:function(){return this.parentScope},has:function(value){var symtable=this.symtable;for(var i in symtable)if(symtable.hasOwnProperty(i)&&symtable[i]==value)return!0;return!1},toStruct:function(){var scope=new Scope;return scope.isStruct=!0,scope.symtable=this.symtable,scope}}},h:function(require,module,exports,global){var _=require("4");module.exports={remoteFileCache:_.cache(40)}},i:function(require,module,exports,global){var fs=null,promise=require("e"),Parser=require("2");exports.get=function(path){var pr;if(/^http/.test(path)&&fs){var request=require("1").request;return pr=promise(),request(path,function(err,response,body){return err?pr.reject(err):void(!err&&response.statusCode>=200&&response.statusCode<400?pr.resolve(body):pr.reject("http request error with code: "+response.statusCode))}),pr}return fs?file(path,"utf8"):http(path)},exports.parse=function(path,options){var p=promise();return options.filename=path,exports.get(path).done(function(text){new Parser(options).parse(text).always(p)}).fail(p),p};var http=function(url){var p=promise(),xhr=new XMLHttpRequest;return xhr.open("GET",url),xhr.onreadystatechange=function(){if(4===xhr.readyState){var status=xhr.status;status>=200&&status<300?p.resolve(xhr.responseText):p.reject(xhr)}},xhr.send(),p},file=function(path){var p=promise();return fs.readFile(path,"utf8",function(error,content){return error?p.reject(error):void p.resolve(content)}),p}},j:function(require,module,exports,global){var Interpreter=require("k");module.exports=Interpreter},k:function(require,module,exports,global){function Interpreter(options){this.options=options}var Walker=require("l"),tree=(require("2"),require("8")),symtab=require("g"),state=require("m"),Event=require("n"),u=(require("e"),require("6"),require("4")),options=(require("i"),require("f")),binop=require("d"),functions=require("o"),color=require("9"),colorify=require("b"),error=require("a"),_=Interpreter.prototype=new Walker,walk=_._walk;state.mixTo(_),options.mixTo(_),Event.mixTo(_),_._walk=function(ast){var res=walk.apply(this,arguments);if(!ast||!ast.type)return res;var name=ast.type.toLowerCase();return this.trigger(name,res||ast),res};var errors={RETURN:u.uid()};({DECLARATION:u.uid()});_.ierror=new Error,_.interpret=function(ast){return this.ast=ast,this.scope=this.globalScope=new symtab.Scope,this.istack=[],this._globalImports=[],this.rulesets=[],this.medias=[],this.indent=0,this._handles||(this._walk=walk),this.walk(ast)},_.walk_default=function(ast){return ast},_.walk_stylesheet=function(ast){var item,plist=ast.list;for(ast.list=[],ast.index=0;plist[ast.index];ast.index++)(item=this.walk(plist[ast.index]))&&u.merge(ast.list,item);return ast},_.walk_directive=function(ast){return ast.value=this.walk(ast.value),ast.block&&(ast.block=this.walk(ast.block)),ast},_.walk_keyframes=function(ast){return ast.name=this.walk(ast.name),ast.block=this.walk(ast.block),ast},_.walk_keyframe=function(ast){return ast.steps=this.walk(ast.steps),ast.block=this.walk(ast.block),ast},_.walk_ruleset=function(ast){this.rulesets.push(ast);var rawSelector=this.walk(ast.selector),values=ast.values,res=[];this.rulesets.pop();var self=this;if(rawSelector.list.forEach(function(complex){var symbols=self.getSymbol(complex.string)||[];symbols.push(ast),self.define(complex.string,symbols)}),ast.abstract&&(rawSelector.list=[]),values||(ast.selector=rawSelector,ast.parent=this.rulesets[this.rulesets.length-1]),ast.lineno=rawSelector.lineno,ast.filename=this.get("filename"),values)for(var i=0,len=values.length;i<len;i++){this.define("$i",{type:"DIMENSION",value:i}),this.define("$item",values[i]);var block=ast.block.clone(),selector=tree.selectorlist([rawSelector.list[i]],ast.lineno),ruleset=new tree.RuleSet(selector,block);res.push(this.walk(ruleset))}else{this.down(ast);var block=this.walk(ast.block);this.up(ast),res=block.exclude(),ast.block=block,res.length&&res.unshift(ast)}return res.length?res:ast},_.walk_selectorlist=function(ast){var list=ast.list,len=list.length;return 1===len&&this.enter("ACCEPT_LIST"),list=this.walk(list),Array.isArray(list[0])&&(list=list[0]),ast.list=list,this.leave("ACCEPT_LIST"),ast},_.walk_complexselector=function(ast){var i,valuesList,ruleset=this.rulesets[this.rulesets.length-1],interpolations=ast.interpolations,len=interpolations.length,values=[];for(i=0;i<len;i++){var value=this.walk(interpolations[i]);"valueslist"===value.type?ruleset.values||!this.state("ACCEPT_LIST")?this.error('con"t has more than 2 interpolations in ComplexSelector',ast):(ruleset.values=value.list,values.push(null)):values.push(tree.toStr(value))}if(ast.string=ast.string.replace(/#\{(\d+)}/g,function(all,index){var value=values[parseInt(index)];return"string"==typeof value?value:"#{interpolation}"}),valuesList=ruleset.values){for(var res=[],toStr=tree.toStr,j=0,jlen=valuesList.length;j<jlen;j++){var value=valuesList[j],string=ast.string.replace(/#\{interpolation}/,function(){return toStr(value)});res.push(new tree.ComplexSelector(string))}return res}return ast},_.walk_operator=function(ast){var op=ast.op,left=this.walk(ast.left),right="&&"==op||"||"==op?ast.right:this.walk(ast.right);return tree.isRelationOp(op)?binop.relation.call(this,left,right,op):binop[op].call(this,left,right)},_.walk_assign=function(ast){if(2==ast.mode){var ref=this.resolve(ast.name);if(ref&&"NULL"!==ref.type)return}(3==ast.mode?this.globalScope:this).define(ast.name,this.walk(ast.value))},_.walk_var=function(ast){var symbol=this.resolve(ast.value);return symbol?(symbol=symbol,symbol.lineno=ast.lineno,symbol):void this.error("Undefined variable: "+ast.value,ast)},_.walk_url=function(ast){var symbol,self=this;return ast.value=ast.value.replace(/#\{(\$\w+)}/g,function(all,name){return(symbol=self.resolve(name))?tree.toStr(symbol):void self.error("Undefined "+name+" in interpolation",ast)}),ast},_.walk_unary=function(ast){var value=this.walk(ast.value),op=ast.op;switch(op){case"+":case"-":"DIMENSION"!==value.type&&this.error(op+" Unary operator only accept DIMENSION bug got "+value.type,ast.lineno);var rvalue="-"===op&&-value.value,node=tree.token("DIMENSION",rvalue,ast.lineno);return node.unit=value.unit,node;case"!":var test=tree.toBoolean(value);return void 0===test&&this.error("! Unary operator dont support valueType: "+value.type,ast.lineno),{type:"BOOLEAN",value:!test,lineno:ast.lineno};default:this.error("Unsupprt Unary operator "+op,ast.lineno)}},_.walk_text=function(ast){var chs=color.maps[ast.value];return chs?new color(chs):ast},_.walk_string=function(ast){var symbol,self=this;return ast.value=ast.value.replace(/#\{(\$\w+)}/g,function(all,name){return(symbol=self.resolve(name))?tree.toStr(symbol):void self.error("not defined String interpolation",ast)}),ast},_.walk_debug=function(ast){var value=this.walk(ast.value);console.log(colorify("DEBUG","yellow")+" "+tree.toStr(value)+"  ("+colorify(value.type,"green")+")\n")},_.walk_if=function(ast){var test=this.walk(ast.test);return tree.toBoolean(test)?this.walk(ast.block):this.walk(ast.alt)},_.walk_for=function(ast){var block,len,item,key,value,list=this.walk(ast.list),index=ast.index,isIn=ast.isIn,by=this.walk(ast.by),element=ast.element,res=[];by=by&&by.value?Math.round(by.value):1,list=list.list?list.list:[list];for(var len=list.length,i=by<0?len-1:0;i<len&&i>=0;i+=by)item=list[i],isIn?("values"!==item.type&&this.error("list in @for in statement must confirm the all elem is values type",ast.list.lineno),value=item.list[1],key=item.list[0]):(value=item,index&&(key=tree.token("DIMENSION",i,ast.list.lineno))),this.define(element,value),index&&this.define(index,key),block=this.walk(ast.block.clone()),res=res.concat(block.list);return res},_.walk_call=function(ast){var params,named,func=this.resolve(ast.name),args=this.walk(ast.args);if(!func||"func"!==func.type){if(func=functions[ast.name]){this.lineno=ast.lineno;var value=tree.convert(func.apply(this,args));return value.lineno=ast.lineno,this.lineno=null,value}if("$"!==ast.name.charAt(0))return ast.args=this.walk(ast.args),ast;this.error("undefined function: "+ast.name,ast)}params=func.params;var prev=this.scope,pref=this.get("filename");if(this.scope=func.scope,this.down(),named=ast.named){for(var i in named){var nindex=named[i];args[nindex]&&(this.define(i,args[nindex]),args.splice(nindex,1))}params=params.filter(function(item){return null==named[item.name]})}for(var i=0,offset=0,len=params.length;i<len;i++){var param=params[i];param.name;if(param.rest){var remained=len-1-i,restArgsLen=args.length-i-remained;restArgsLen=restArgsLen>=0?restArgsLen:0;var restArgs=args.slice(i,i+restArgsLen),passArg=tree.valueslist(restArgs,ast.lineno);this.define(param.name,passArg),offset+=restArgsLen-1}else{var value=args[i+offset]||param.default;value?this.define(param.name,value):this.define(param.name,tree.null(args.lineno))}}this.define("$arguments",new tree.ValuesList(args));try{this.set("filename",func.filename);var block=this.walk(func.block.clone())}catch(err){if(err.code===errors.RETURN){var value=tree.convert(err.value);return this.up(),this.scope=prev,this.set("filename",pref),value}throw err}return this.up(),this.scope=prev,this.set("filename",pref),block},_.walk_return=function(ast){throw _.ierror.code=errors.RETURN,_.ierror.value=this.walk(ast.value),_.ierror},_.walk_func=function(ast){return ast.params=this.walk(ast.params),ast.scope||(ast.scope=this.scope),ast.filename=this.get("filename"),ast},_.walk_param=function(ast){return ast.default&&(ast.default=this.walk(ast.default)),ast},_.walk_module=function(ast){this.walk(ast.block)},_.walk_extend=function(ast){var ruleset=this.rulesets[this.rulesets.length-1];ruleset||this.error("can not use @extend outside ruleset",ast);var selector=this.walk(ast.selector),self=this;selector.list.forEach(function(item){var extendz=self.resolve(item.string);extendz&&extendz.forEach(function(extend){extend&&extend.addRef(ruleset)})})},_.walk_import=function(ast){this.walk(ast.url);ast.url;if(ast.stylesheet){var queryList=ast.queryList,stylesheet=ast.stylesheet;if(queryList.length){var media=new tree.Media(queryList,stylesheet);return this.walk(media)}if(~this._globalImports.indexOf(ast.filename)&&this.scope===this.globalScope)return void u.log(colorify("WARNING:","yellow")+"("+ast.filename+") is import twice, mcss forbid default");this._globalImports.push(ast.filename);var pre=this.get("filename");this.set("filename",ast.filename);var list=this.walk(stylesheet).list;return this.set("filename",pre),list}return ast},_.walk_media=function(ast){ast.queryList=this.walk(ast.queryList);var ruleset,newRuleset,rulesets=this.rulesets;this.concatMedia(ast),this.down(null,ast),this.walk(ast.block),this.up(null,ast);var res=ast.block.exclude(!0);if(res.length){if(Array.isArray(res[0])){var declarations=res.shift();declarations.length&&rulesets.length&&(ruleset=rulesets[rulesets.length-1],newRuleset=new tree.RuleSet(ruleset.selector,new tree.Block(declarations)),newRuleset.parent=ruleset.parent,newRuleset.lineno=declarations[0].value.lineno||declarations[0].property.lineno,ast.block.list.unshift(newRuleset))}res.unshift(ast)}return res.length?res:ast},_.walk_mediaquery=function(ast){return ast.expressions=this.walk(ast.expressions),ast},_.walk_mediaexpression=function(ast){return ast.feature=this.walk(ast.feature),ast.value=this.walk(ast.value),ast},_.walk_block=function(ast){var r,list=ast.list,res=[],i=0;for(list.length;i<list.length;i++)list[i]&&(r=this.walk(list[i]))&&u.merge(res,r);return ast.list=res,ast},_.walk_declaration=function(ast){return this.enter("DECLARATION"),ast.property=this.walk(ast.property),ast.value=this.walk(ast.value),this.leave("DECLARATION"),ast},_.walk_compoundident=function(ast){var text="",self=this;return this.walk(ast.list).forEach(function(item){text+="string"==typeof item?item:tree.toStr(self.walk(item))}),{type:"TEXT",value:text,lineno:ast.lineno}},_.walk_valueslist=function(ast){return ast.list=this.walk(ast.list),ast},_.walk_values=function(ast){return ast.list=this.walk(ast.list),ast},_.walk_range=function(ast){var start=this.walk(ast.start),end=this.walk(ast.end);ast.lineno;"DIMENSION"===start.type&&"DIMENSION"===end.type||this.error('range"s start and end must be all DIMENSION type');for(var svalue=Math.round(start.value),evalue=Math.round(end.value),list=[];svalue<=evalue;svalue++)list.push(tree.token("DIMENSION",svalue,ast.lineno));return tree.valueslist(list,ast.lineno)},_.down=function(ruleset,media){ruleset&&this.rulesets.push(ruleset),media&&this.medias.push(media),this.scope=new symtab.Scope(this.scope)},_.up=function(ruleset,media){ruleset&&this.rulesets.pop(),media&&this.medias.pop(),this.scope=this.scope.getOuterScope()},_.concatMedia=function(media){var ss=this.medias;if(!ss.length)return media;var s,m,mm,sm,nm,slist=ss[ss.length-1].queryList,mlist=media.queryList,queryList=[],slen=slist.length,mlen=mlist.length;for(m=0;m<mlen;m++)for(mm=mlist[m],s=0;s<slen;s++){if(sm=slist[s],nm=new tree.MediaQuery,sm.mediaType&&mm.mediaType){var noConcat=!0;break}nm.mediaType=mm.mediaType||sm.mediaType,nm.expressions=sm.expressions.concat(mm.expressions),queryList.push(nm)}return noConcat||(media.queryList=queryList),media},_.push=function(scope){this.istack.push(scope)},_.pop=function(){this.istack.pop()},_.peek=function(){var len;if(len=this.istack.length)return this.istack[len-1]},_.getScope=function(){return this.peek()||this.scope},_.define=function(id,symbol){this.scope.define(id,symbol)},_.resolve=function(id){var scope,symbol;return(scope=this.peek())&&(symbol=scope.resolve(id))?symbol:this.scope.resolve(id)},_.getSymbol=function(id){return this.scope.getSymbol(id)},_.expect=function(ast,type){this._inspect(ast)!==type&&this.error('interpreter error! expect node: "'+type+'" got: "'+ast.type+'"',ast)},_.error=function(msg,ll){if(ll)var lineno=ll.lineno||ll;else lineno=this.lineno;throw new error.McssError(msg,lineno,this.options)},module.exports=Interpreter},l:function(require,module,exports,global){var _=require("4"),Walker=function(){};Walker.prototype={constructor:Walker,walk:function(node){return Array.isArray(node)?this._walkArray(node):this._walk(node)},walk_defaut:function(node){return node.list||node.body?this.walk(node.list||node.body):node.type&&this.walk_token?this.walk_token(node):void _.warn('no "'+this._inspect(node)+'" walk defined')},_walkArray:function(nodes){var self=this,res=[];return nodes.forEach(function(node){node&&res.push(self._walk(node))}),res},_walk:function(node){var sign=this._inspect(node),name="walk_"+sign;return this[name]?this[name](node):this.walk_default(node)},_inspect:function(node){return node&&node.type?node.type.toLowerCase():null},error:function(e){throw e}},module.exports=Walker},m:function(require,module,exports,global){function ex(o1,o2,override){for(var i in o2)(null==o1[i]||override)&&(o1[i]=o2[i])}var API={state:function(state){var _states=this._states||(this._states=[]);return _states.some(function(item){return item===state})},enter:function(state){var _states=this._states||(this._states=[]);_states.push(state)},leave:function(state){var _states=this._states||(this._states=[]);state&&state!==_states[_states.length-1]||_states.pop()}};exports.mixTo=function(obj){obj="function"==typeof obj?obj.prototype:obj,ex(obj,API)}},n:function(require,module,exports,global){function Event(handles){arguments.length&&this.on.apply(this,arguments)}var slice=[].slice,ex=function(o1,o2,override){for(var i in o2)(null==o1[i]||override)&&(o1[i]=o2[i])},API={on:function(event,fn){if("object"==typeof event)for(var i in event)this.on(i,event[i]);else{var handles=this._handles||(this._handles={}),calls=handles[event]||(handles[event]=[]);calls.push(fn)}return this},off:function(event,fn){if(event&&(this._handles=[]),this._handles){var calls,handles=this._handles;if(calls=handles[event]){if(!fn)return handles[event]=[],this;for(var i=0,len=calls.length;i<len;i++)if(fn===calls[i])return calls.splice(i,1),this}return this}},trigger:function(event){var calls,args=slice.call(arguments,1),handles=this._handles;if(!handles||!(calls=handles[event]))return this;for(var i=0,len=calls.length;i<len;i++)calls[i].apply(this,args);return this},hasEvent:function(event){var handles=this._handles;return handles&&(calls=handles[event])&&calls.length}};ex(Event.prototype,API),Event.mixTo=function(obj){obj="function"==typeof obj?obj.prototype:obj,ex(obj,API)},module.exports=Event},o:function(require,module,exports,global){function converToBase64(imagePath){imagePath=imagePath.replace(/[?#].*/g,"");var stat,img,extname=path.extname(imagePath);try{return stat=fs.statSync(imagePath),!(stat.size>6144)&&(img=fs.readFileSync(imagePath,"base64"),"data:"+mediatypes[extname]+";base64,"+img)}catch(e){return!1}}function getAlpha(node){if(node)var res="%"===node.unit?node.value/100:node.value;return res}var fs=null,path=null,tree=require("8"),binop=require("d"),u=require("4"),tk=require("3"),Color=tree.Color,_=module.exports={rgba:u.accept(function(r,g,b,a){return arguments.length<2&&this.error("param error"),"color"===r.type?new Color(r,getAlpha(g)):new Color([r.value,g.value,b.value],getAlpha(a))},["DIMENSION color","DIMENSION","DIMENSION","DIMENSION"]),rgb:function(){return _.rgba.apply(this,arguments)},hsla:u.accept(function(h,s,l,a){arguments.length<3&&this.error("hsla need at least 3 arguments got:"+arguments.length),"%"===s.unit&&"%"===l.unit||this.error("hsl param saturation and light all only accept percent"),a&&"%"===a.unit&&(a.value/=100);var node=Color.hsl([h.value,s.value,l.value],a&&a.value);return node},["DIMENSION","DIMENSION","DIMENSION","DIMENSION"]),hsl:function(){return _.hsla.apply(this,arguments)},mix:u.accept(function(c1,c2,weight){weight&&"%"!==weight.unit&&this.error("weight param must be a percent");var a=c1.alpha-c2.alpha,p=(weight&&weight.value||50)/100,w=2*p-1,w1=((w*a==-1?w:(w+a)/(1+w*a))+1)/2,w2=1-w1,alpha=c1.alpha*p+c2.alpha*(1-p),channels=[c1[0]*w1+c2[0]*w2,c1[1]*w1+c2[1]*w2,c1[2]*w1+c2[2]*w2];return new Color(channels,alpha,c1.lineno)},["color","color","DIMENSION"]),define:u.accept(function(name,value,global){name=name.value,name&&value||this.error("invalid passed param in define");var scope=tree.toBoolean(global)?this.globalScope:this.scope;scope.define(name,value)},["TEXT STRING"]),apply:u.accept(function(func,args){func||this.error('function "apply" atleast need one prams'),func.name||this.define("null",func);var call=tree.call(func.name||"null",args&&args.list||[]);return this.walk(call)},["func","valueslist values"]),typeof:function(node){return node.type.toLowerCase()},js:u.accept(function(string){try{return eval("("+string.value+")")}catch(e){this.error(e.message)}},["STRING"]),join:u.accept(function(list,separator){return separator=separator?separator.value:"-",tree.token("TEXT",list.list.map(tree.toStr).join(separator),list.lineno)},["valueslist values","TEXT STRING"]),t:function(node){var text=tree.toStr(node);return null==text&&(text=""),tree.token("TEXT",text,node.lineno)},match:u.accept(function(reg,str){if(!str||"STRING"!==str.type&&"TEXT"!==str.type)return!1;var testReg=new RegExp(reg.value),strValue=str.value||"";return testReg.test(strValue)},["STRING TEXT"]),error:u.accept(function(message){this.error(message.value)},["STRING"]),index:u.accept(function(list,index){var elem;return index&&"DIMENSION"===index.type||this.error("invalid param:index passed to args()"),(elem=list.list[index.value])?elem:tree.null()},["valueslist values","DIMENSION"]),values:function(value){return tree.values(value&&[value])},valueslist:function(value){return tree.valueslist(value&&[value])},flattern:function(){},slice:u.accept(function(list,start,end){var clist=list.list.slice(start&&start.value||0,end&&end.value||list.list.length);return tree[list.type](clist)},["valueslist values","DIMENSION","DIMENSION"]),args:function(index){var args=this.resolve("$arguments");return args||this.error("the args() must be called in function block"),_.index.call(this,args,index)},len:u.accept(function(list){return tree.token("DIMENSION",list.list.length,list.lineno)},["values valueslist"]),last:u.accept(function(list){return list.list[list.length-1]},["values valueslist"]),"is-list":function(list){return!(!list||!list.list)},"data-uri":u.accept(function(string){var value=string.value,url={type:"URL",value:value};if(fs){var fullname=path.resolve(path.dirname(this.get("filename")),value),base64=converToBase64(fullname);return base64?(url.value=base64,url):url}return url},["STRING"])};_.list=u.accept(function(list,index,value){},["values valueslist"]),["push","unshift","pop","shift"].forEach(function(name){_[name.toLowerCase()]=function(list,item){var type=list.type;return"valueslist"!==type&&"values"!==type&&this.error(name+" first param only accept values or valueslist"),list.list[name](item)}}),_["-adjust"]=u.accept(function(color,prop,weight,absolute){var p=prop.value,key=channelsMap[p],isAbsolute=tree.toBoolean(absolute);if(isRGBA(p)){if(!weight)return color[key];"a"===p&&"%"===weight.unit&&(weight.unit=null,weight.value/=100),weight.unit&&this.error("rgba adjust only accept NUMBER");var clone=color.clone();return isAbsolute?clone[key]=weight.value:clone[key]+=weight.value,Color.limit(clone),clone}if(isHSL(p)){var hsl=color.toHSL();if(!weight){switch(p){case"saturation":case"lightness":return{type:"DIMENSION",value:hsl[key],unit:"%"}}return hsl[key]}isAbsolute?hsl[key]=weight.value:hsl[key]+=weight.value;var node=Color.hsl(hsl,color.alpha);return node.lineno=color.lineno,node}this.error("invalid adjust property "+p+" "+color.lineno)},["color","STRING","DIMENSION"]);var RGBA_STR="red green blue alpha",HSL_STR="hue saturation lightness",isRGBA=u.makePredicate(RGBA_STR),isHSL=u.makePredicate(HSL_STR),channelsMap={hue:0,saturation:1,lightness:2,red:0,green:1,blue:2,alpha:"alpha"};_.argb=u.accept(function(color){return color.toCSS(!0)},["color"]),(RGBA_STR+" "+HSL_STR).split(" ").forEach(function(name){var text=tk.createToken("STRING",name);_[name.charAt(0)+"-adjust"]=_[name]=function(color,amount,absolute){return _["-adjust"].call(this,color,text,amount,absolute)}}),_.fade=_.alpha,delete _.alpha,["floor","ceil","round","abs","max","min","sin","cos","tan"].forEach(function(name){_[name]=u.accept(function(d){arguments.length<1&&this.error("at least pass one argument");var clone=tree.cloneNode(d),args=u.slice(arguments).map(function(item){return item.value});return clone.value=Math[name].apply(Math,args),clone},["DIMENSION"])});var mediatypes={".eot":"application/vnd.ms-fontobject",".gif":"image/gif",".ico":"image/vnd.microsoft.icon",".jpg":"image/jpeg",".jpeg":"image/jpeg",".otf":"application/x-font-opentype",".png":"image/png",".svg":"image/svg+xml",".ttf":"application/x-font-ttf",".webp":"image/webp",".woff":"application/x-font-woff"}},p:function(require,module,exports,global){var Translator=require("q");module.exports=Translator},q:function(require,module,exports,global){function Translator(options){this.options=options||{}}var Walker=require("l"),tree=require("8"),error=require("a"),u=require("4"),options=require("f"),path=null,buffer=require("r"),_=Translator.prototype=new Walker;_.walk;options.mixTo(_);_.translate=function(ast){this.ast=ast,this.buffer=buffer(this.options),this.level=0,this.indent=this.get("indent")||"\t",this.newline=this.get("format")>1?"":"\n",this.walk_stylesheet(ast,!0);var text=this.buffer.toString();if(path&&this.options.sourceMap&&this.options.dest){new Buffer(this.buffer.getMap()).toString("base64");text+="/*@ sourceMappingURL= "+path.basename(this.get("dest"),".css")+".css.map */";var sfilepath=this.get("dest")+".map";u.writeFile(sfilepath,this.buffer.getMap(),function(err){err&&console.error("sourcemap wirte fail"),console.log(sfilepath+" sourcemap generated")})}return text},_.walk_stylesheet=function(ast,blank){this.walk_block(ast,blank)},_.walk_ruleset=function(ast){var buffer=this.buffer,slist=ast.getSelectors(),parent=ast.parent;if(!slist||!slist.length)return!1;for(;parent;){if(0==parent.getSelectors().length)return!1;parent=parent.parent}return"number"==typeof ast.lineno&&ast.filename&&buffer.addMap({line:ast.lineno-1,source:ast.filename}),!!ast.block.list.length&&(buffer.add(this.walk(ast.selector.list).join(",")),void this.walk(ast.block))},_.walk_selectorlist=function(ast){return this.walk(ast.list).join(","+this.newline)},_.walk_complexselector=function(ast){return ast.string},_.walk_block=function(ast,blank){this.level++;var indent=this.indents(),buffer=this.buffer;blank||buffer.add("{");var list=ast.list;blank||buffer.add(this.newline+indent);for(var i=0,len=list.length;i<len;i++){var item=this.walk(list[i]);item!==!1&&("declaration"!==list[i].type&&this.has("format",3)&&""!==item&&buffer.add("\n"),i!==len-1&&""!==item&&buffer.add(this.newline+indent))}this.level--,blank||buffer.add(this.newline+this.indents()+"}")},_.walk_valueslist=function(ast){var text=this.walk(ast.list).join(",");return text},_.walk_values=function(ast){var text=this.walk(ast.list).join(" ");return text=text.replace(/ \/ /g,"/")},_.walk_import=function(ast){var outport=["@import ",this.walk_url(ast.url)];ast.queryList&&ast.queryList.length&&outport.push(this.walk(ast.queryList).join(",")),this.buffer.add(outport.join(" ")+";")},_.walk_media=function(ast){var str="@media ";str+=this.walk(ast.queryList).join(","),this.buffer.add(str),this.walk_block(ast.block)},_.walk_mediaquery=function(ast){var outport=this.walk(ast.expressions);return ast.mediaType&&outport.unshift(ast.mediaType),outport.join(" and ")},_.walk_mediaexpression=function(ast){var str="";return str+=this.walk(ast.feature),ast.value&&(str+=": "+this.walk(ast.value)),"("+str+")"},_.walk_keyframes=function(ast){var buffer=(this.get("prefix"),this.buffer),str="@"+ast.fullname+" "+this.walk(ast.name);buffer.add(str),this.walk(ast.block)};var stepmap={from:"0%",to:"100%"};_.walk_keyframe=function(ast){var self=this,steps=ast.steps.map(function(item){var step;return"TEXT"===item.type&&(step=stepmap[item.value.toLowerCase()])?step:"DIMENSION"===item.type&&"%"==item.unit?tree.toStr(item):void self.error("@keyframe step only accept [from | to | <percentage>]",item.lineno)});this.buffer.add(this.newline+this.indents()+steps.join(",")),this.walk(ast.block)},_.walk_declaration=function(ast){var text=this.walk(ast.property),value=this.walk(ast.value),str=text+":"+value+(ast.important?" !important":"");this.buffer.add(str+";")},_.walk_string=function(ast){return'"'+ast.value+'"'},_["walk_="]=function(ast){return"="},_["walk_/"]=function(ast){return"/"},_.walk_unknown=function(ast){return ast.name},_.walk_url=function(ast){return'url("'+ast.value+'")'},_.walk_color=function(ast){return ast.toCSS()},_.walk_directive=function(ast){var str="@"+ast.fullname+" ";ast.value&&(str+=this.walk(ast.value)),this.buffer.add(str),ast.block?this.walk(ast.block):this.buffer.add(";")},_.walk_call=function(ast){return ast.name+"("+this.walk(ast.args).join(",")+")"},_.walk_default=function(ast){if(!ast)return"";var str=tree.toStr(ast);
return"string"!=typeof str?"":str},_.error=function(msg,ll){var lineno=ll.lineno||ll;throw new error.McssError(msg,lineno,this.options)},_.indents=function(){return this.get("format")>1?"":Array(this.level).join(this.indent)},_._getSassDebugInfo=function(){return"@media -sass-debug-info"},module.exports=Translator},r:function(require,module,exports,global){var path=null;module.exports=function(options){var sourceMap=require("1").sourcemap,options=options||{},generator=path&&options.sourceMap?new sourceMap.SourceMapGenerator({file:path.basename(options.dest)}):null,lines=1,column=0,outport="",marked=null;return{add:function(content){if(options.sourceMap){var newline=(content.match(/\n/g)||"").length;lines+=newline;var clen=content.length;newline?column=clen-content.lastIndexOf("\n")-1:column+=clen}"string"==typeof marked&&(marked+=content),outport+=content},addMap:function(map){options.sourceMap&&generator.addMapping({generated:{column:column,line:lines},source:path.relative(path.dirname(options.dest),map.source),original:{column:1,line:map.line}})},toString:function(){return outport},getMap:function(){return generator?generator.toString():null},mark:function(){marked=""},restore:function(){var res=marked;return marked=null,res}}}},s:function(require,module,exports,global){module.exports={prefixr:require("t"),csscomb:require("v")}},t:function(require,module,exports,global){var _=(require("u").prefixs,require("4")),isTestProperties=(require("8"),_.makePredicate("border-radius transition"));module.exports={block:function(tree){for(var list=tree.list,len=list.length;len--;){var declaration=list[len];isTestProperties(declaration.property)&&list.splice(len,0,declaration.clone("-webkit-"+declaration.property),declaration.clone("-moz-"+declaration.property),declaration.clone("-mz-"+declaration.property),declaration.clone("-o-"+declaration.property))}}}},u:function(require,module,exports,global){exports.orders={position:1,"z-index":1,top:1,right:1,bottom:1,left:1,display:2,visibility:2,float:2,clear:2,overflow:2,"overflow-x":2,"overflow-y":2,"-ms-overflow-x":2,"-ms-overflow-y":2,clip:2,zoom:2,"flex-direction":2,"flex-order":2,"flex-pack":2,"flex-align":2,"-webkit-box-sizing":3,"-moz-box-sizing":3,"box-sizing":3,width:3,"min-width":3,"max-width":3,height:3,"min-height":3,"max-height":3,margin:3,"margin-top":3,"margin-right":3,"margin-bottom":3,"margin-left":3,padding:3,"padding-top":3,"padding-right":3,"padding-bottom":3,"padding-left":3,"table-layout":4,"empty-cells":4,"caption-side":4,"border-spacing":4,"border-collapse":6,"list-style":4,"list-style-position":4,"list-style-type":4,"list-style-image":4,content:5,quotes:5,"counter-reset":5,"counter-increment":5,resize:5,cursor:5,"nav-index":5,"nav-up":5,"nav-right":5,"nav-down":5,"nav-left":5,"-webkit-transition":5,"-moz-transition":5,"-ms-transition":5,"-o-transition":5,transition:5,"-webkit-transition-delay":5,"-moz-transition-delay":5,"-ms-transition-delay":5,"-o-transition-delay":5,"transition-delay":5,"-webkit-transition-timing-function":5,"-moz-transition-timing-function":5,"-ms-transition-timing-function":5,"-o-transition-timing-function":5,"transition-timing-function":5,"-webkit-transition-duration":5,"-moz-transition-duration":5,"-ms-transition-duration":5,"-o-transition-duration":5,"transition-duration":5,"-webkit-transition-property":5,"-moz-transition-property":5,"-ms-transition-property":5,"-o-transition-property":5,"transition-property":5,"-webkit-transform":5,"-moz-transform":5,"-ms-transform":5,"-o-transform":5,transform:5,"-webkit-transform-origin":5,"-moz-transform-origin":5,"-ms-transform-origin":5,"-o-transform-origin":5,"transform-origin":5,"-webkit-animation":5,"-moz-animation":5,"-ms-animation":5,"-o-animation":5,animation:5,"-webkit-animation-name":5,"-moz-animation-name":5,"-ms-animation-name":5,"-o-animation-name":5,"animation-name":5,"-webkit-animation-duration":5,"-moz-animation-duration":5,"-ms-animation-duration":5,"-o-animation-duration":5,"animation-duration":5,"-webkit-animation-play-state":5,"-moz-animation-play-state":5,"-ms-animation-play-state":5,"-o-animation-play-state":5,"animation-play-state":5,"-webkit-animation-timing-function":5,"-moz-animation-timing-function":5,"-ms-animation-timing-function":5,"-o-animation-timing-function":5,"animation-timing-function":5,"-webkit-animation-delay":5,"-moz-animation-delay":5,"-ms-animation-delay":5,"-o-animation-delay":5,"animation-delay":5,"-webkit-animation-iteration-count":5,"-moz-animation-iteration-count":5,"-ms-animation-iteration-count":5,"-o-animation-iteration-count":5,"animation-iteration-count":5,"-webkit-animation-direction":5,"-moz-animation-direction":5,"-ms-animation-direction":5,"-o-animation-direction":5,"animation-direction":5,"text-align":5,"-webkit-text-align-last":5,"-moz-text-align-last":5,"-ms-text-align-last":5,"text-align-last":5,"vertical-align":5,"white-space":5,"text-decoration":5,"text-emphasis":5,"text-emphasis-color":5,"text-emphasis-style":5,"text-emphasis-position":5,"text-indent":5,"-ms-text-justify":5,"text-justify":5,"text-transform":5,"letter-spacing":5,"word-spacing":5,"-ms-writing-mode":5,"text-outline":5,"text-wrap":5,"text-overflow":5,"-ms-text-overflow":5,"text-overflow-ellipsis":5,"text-overflow-mode":5,"-ms-word-wrap":5,"word-wrap":5,"word-break":5,"-ms-word-break":5,"-moz-tab-size":5,"-o-tab-size":5,"tab-size":5,"-webkit-hyphens":5,"-moz-hyphens":5,hyphens:5,"pointer-events":5,opacity:6,"filter:progid:DXImageTransform.Microsoft.Alpha(Opacity":6,"-ms-filter:'progid:DXImageTransform.Microsoft.Alpha":6,"-ms-interpolation-mode":6,color:6,border:6,"border-width":6,"border-style":6,"border-color":6,"border-top":6,"border-top-width":6,"border-top-style":6,"border-top-color":6,"border-right":6,"border-right-width":6,"border-right-style":6,"border-right-color":6,"border-bottom":6,"border-bottom-width":6,"border-bottom-style":6,"border-bottom-color":6,"border-left":6,"border-left-width":6,"border-left-style":6,"border-left-color":6,"-webkit-border-radius":6,"-moz-border-radius":6,"border-radius":6,"-webkit-border-top-left-radius":6,"-moz-border-radius-topleft":6,"border-top-left-radius":6,"-webkit-border-top-right-radius":6,"-moz-border-radius-topright":6,"border-top-right-radius":6,"-webkit-border-bottom-right-radius":6,"-moz-border-radius-bottomright":6,"border-bottom-right-radius":6,"-webkit-border-bottom-left-radius":6,"-moz-border-radius-bottomleft":6,"border-bottom-left-radius":6,"-webkit-border-image":6,"-moz-border-image":6,"-o-border-image":6,"border-image":6,"-webkit-border-image-source":6,"-moz-border-image-source":6,"-o-border-image-source":6,"border-image-source":6,"-webkit-border-image-slice":6,"-moz-border-image-slice":6,"-o-border-image-slice":6,"border-image-slice":6,"-webkit-border-image-width":6,"-moz-border-image-width":6,"-o-border-image-width":6,"border-image-width":6,"-webkit-border-image-outset":6,"-moz-border-image-outset":6,"-o-border-image-outset":6,"border-image-outset":6,"-webkit-border-image-repeat":6,"-moz-border-image-repeat":6,"-o-border-image-repeat":6,"border-image-repeat":6,outline:6,"outline-width":6,"outline-style":6,"outline-color":6,"outline-offset":6,background:6,"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader":6,"background-color":6,"background-image":6,"background-repeat":6,"background-attachment":6,"background-position":6,"background-position-x":6,"-ms-background-position-x":6,"background-position-y":6,"-ms-background-position-y":6,"background-clip":6,"background-origin":6,"-webkit-background-size":6,"-moz-background-size":6,"-o-background-size":6,"background-size":6,"box-decoration-break":6,"-webkit-box-shadow":6,"-moz-box-shadow":6,"box-shadow":6,"filter:progid:DXImageTransform.Microsoft.gradient":6,"-ms-filter:'progid:DXImageTransform.Microsoft.gradient":6,"text-shadow":6,font:7,"font-family":7,"font-size":7,"font-weight":7,"font-style":7,"font-variant":7,"font-size-adjust":7,"font-stretch":7,"font-effect":7,"font-emphasize":7,"font-emphasize-position":7,"font-emphasize-style":7,"font-smooth":7,"line-height":7}},v:function(require,module,exports,global){var orders=require("u").orders;module.exports={block:function(tree){var list=tree.list;list[0]&&"declaration"===list[0].type&&list.sort(function(d1,d2){return(orders[d1.property.value]||100)-(orders[d2.property.value]||100)})}}},w:function(require,module,exports,global){module.exports={io:require("i"),Event:require("n"),color:require("b"),options:require("f"),path:require("6"),promise:require("e"),state:require("m"),tpl:require("7"),util:require("4"),watcher:require("x")}},x:function(require,module,exports,global){function Watcher(options){this.set({persistent:!1}),this.set(options),this._files=options.files,this.files={},this.running=!1}var _=require("4"),options=require("f"),Event=require("n"),fs=null,w=options.mixTo(Watcher);Event.mixTo(Watcher),w.add=function(file){var files=[];return _.flatten(arguments).forEach(function(fullpath){try{var stat=fs.statSync()}catch(e){}stat.isDirectory(),stat.isFile()}),_.flatten(files)},w._add=function(fullpath){this._files.push(file),this.running},w.remove=function(fullpath){},w.watch=function(){this.running||(this.running=!0,process.on("SIGINT",function(){process.exit()}),process.on("exit",function(){self.emit("end"),(callback||util.noop)()}))},w._watch=function(callback){var self=this,watchers={},files=this.files,persistent=this.get("persistent"),changed=function(file){for(var p in watchers)watchers[p].close();self.trigger("change",file),callback()};for(var fullpath in files)if(files.hasOwnProperty(fullpath)){files[fullpath];fs.readFile(fullpath,"utf-8",function(err,src){return err?callback(err):void(watchers[fullpath]=fs.watch(fullpath,{persistent:persistent},_.throttle(function(){fs.readFile(fullpath,"utf-8",function(err,now){err&&"ENOENT"==err.code?changed(fullpath):err?callback(err):now!=src&&changed(fullpath)})},100)))})}}}});